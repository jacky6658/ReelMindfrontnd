<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    
    <!-- Primary SEO Meta Tags -->
    <title>å‰µä½œè€…è³‡æ–™åº« - ReelMind AI çŸ­å½±éŸ³æ™ºèƒ½é«” | å€‹äººè³‡æ–™ Ã— æˆ‘çš„è…³æœ¬ Ã— å¸³è™Ÿå®šä½ Ã— è¨‚å–®ç®¡ç†</title>
    <meta name="title" content="å‰µä½œè€…è³‡æ–™åº« - ReelMind AI çŸ­å½±éŸ³æ™ºèƒ½é«” | å€‹äººè³‡æ–™ Ã— æˆ‘çš„è…³æœ¬ Ã— å¸³è™Ÿå®šä½ Ã— è¨‚å–®ç®¡ç†" />
    <meta name="description" content="ReelMind å‰µä½œè€…è³‡æ–™åº«ï¼šç®¡ç†æ‚¨çš„å€‹äººè³‡æ–™ã€è…³æœ¬è¨˜éŒ„ã€å¸³è™Ÿå®šä½ã€é¸é¡Œå…§å®¹ã€IPäººè¨­è¦åŠƒã€è¨‚å–®è¨˜éŒ„å’Œç³»çµ±è¨­å®šã€‚" />
    <meta name="keywords" content="å‰µä½œè€…è³‡æ–™åº«,å€‹äººè³‡æ–™,è…³æœ¬ç®¡ç†,å¸³è™Ÿå®šä½,IPäººè¨­è¦åŠƒ,çŸ­å½±éŸ³å·¥å…·" />
    <meta name="author" content="ReelMind AI" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="zh-Hant" />
    <link rel="canonical" href="https://reelmind.aijob.com.tw/userDB.html" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://reelmind.aijob.com.tw/userDB.html" />
    <meta property="og:title" content="å‰µä½œè€…è³‡æ–™åº« - ReelMind AI çŸ­å½±éŸ³æ™ºèƒ½é«”" />
    <meta property="og:description" content="ç®¡ç†æ‚¨çš„å€‹äººè³‡æ–™ã€è…³æœ¬è¨˜éŒ„ã€å¸³è™Ÿå®šä½ã€é¸é¡Œå…§å®¹å’Œè¨‚å–®è¨˜éŒ„ã€‚" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="å‰µä½œè€…è³‡æ–™åº« - ReelMind AI çŸ­å½±éŸ³æ™ºèƒ½é«”" />
    <meta name="twitter:description" content="ç®¡ç†æ‚¨çš„å€‹äººè³‡æ–™ã€è…³æœ¬è¨˜éŒ„ã€å¸³è™Ÿå®šä½ã€é¸é¡Œå…§å®¹å’Œè¨‚å–®è¨˜éŒ„ã€‚" />
    
    <!-- HTTP å¿«å–æ¨™é ­ -->
    <meta http-equiv="Cache-Control" content="public, max-age=3600">
    <meta http-equiv="Expires" content="3600">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EğŸ¬%3C/text%3E%3C/svg%3E" />
    
    <!-- Font Awesome åœ–æ¨™åº« -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- CSS æ–‡ä»¶ -->
    <link rel="stylesheet" href="assets/css/variables.css" />
    <link rel="stylesheet" href="assets/css/animations.css" />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
    
    <!-- UserDB å°ˆç”¨æ¨£å¼ï¼ˆå¾ index.html æå–ï¼‰ -->
    <style>
      /* ===== å°èˆªæ¬„æ¨£å¼ï¼ˆé›»è…¦ç‰ˆå’Œæ‰‹æ©Ÿç‰ˆï¼‰ ===== */
      .top-navbar {
        background: var(--navbar-bg);
        border-bottom: 1px solid var(--border-color);
        padding: 16px 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 1px 3px var(--shadow);
        padding-top: calc(16px + env(safe-area-inset-top, 0px)); /* iOS å®‰å…¨å€åŸŸ */
        padding-left: calc(24px + env(safe-area-inset-left, 0px)); /* iOS å®‰å…¨å€åŸŸ */
        padding-right: calc(24px + env(safe-area-inset-right, 0px)); /* iOS å®‰å…¨å€åŸŸ */
        min-height: 60px;
        position: sticky;
        top: 0;
        z-index: 100;
        transition: background-color 0.3s ease, border-color 0.3s ease;
      }
      
      .navbar-left {
        display: flex;
        align-items: center;
        gap: 24px;
        justify-content: flex-start;
      }
      
      .navbar-title {
        font-size: 30px;
        font-weight: 600;
        color: var(--text-primary);
        text-align: center;
        transition: color 0.3s ease;
        justify-self: center;
      }
      
      .clickable-title {
        cursor: pointer;
        transition: color 0.2s ease;
      }
      
      .clickable-title:hover {
        color: #3b82f6;
      }
      
      .navbar-tabs {
        display: flex;
        gap: 8px;
      }
      
      .navbar-tab {
        padding: 8px 16px;
        border: none;
        background: transparent;
        color: var(--text-secondary);
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
        text-decoration: none;
      }
      
      .navbar-tab.active {
        background: var(--button-bg);
        color: var(--button-text);
      }
      
      .navbar-tab:hover:not(.active) {
        background: var(--bg-tertiary);
      }
      
      .navbar-right {
        display: flex;
        align-items: center;
        gap: 16px;
        justify-content: flex-end;
      }
      
      .user-info {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-secondary);
        font-size: 14px;
        transition: color 0.3s ease;
        cursor: pointer;
        padding: 8px 12px;
        border-radius: 8px;
        transition: background 0.2s;
      }
      
      .user-info:hover {
        background: #f3f4f6;
      }
      
      .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        border: 2px solid #e5ecef;
        object-fit: cover;
        object-position: center;
      }
      
      .user-name {
        font-size: 14px;
        font-weight: 500;
        color: #374151;
      }
      
      .auth-buttons {
        display: flex;
        gap: 8px;
      }
      
      .login-btn, .logout-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }
      
      .login-btn {
        background: #3b82f6;
        color: white;
      }
      
      .login-btn:hover {
        background: #2563eb;
      }
      
      .logout-btn {
        background: #ef4444;
        color: white;
      }
      
      .logout-btn:hover {
        background: #dc2626;
      }
      
      /* æ‰‹æ©Ÿç‰ˆæŠ½å±œæŒ‰éˆ• */
      .mobile-drawer-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 24px;
        color: var(--text-primary);
        cursor: pointer;
        padding: 8px;
        min-width: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
        min-height: 44px;
        margin-right: 12px;
        border-radius: 4px;
        transition: background-color 0.2s;
        -webkit-tap-highlight-color: transparent; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
        touch-action: manipulation; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
      }
      
      .mobile-drawer-toggle:hover {
        background-color: #f3f4f6;
      }
      
      .hamburger-icon {
        display: block;
      }
      
      .mobile-drawer-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        display: none;
      }
      
      .mobile-drawer {
        position: fixed;
        top: 0;
        left: -300px;
        width: 280px;
        height: 100%;
        height: 100dvh; /* ä½¿ç”¨å‹•æ…‹è¦–çª—é«˜åº¦ï¼ˆæ”¯æ´ iOS Safariï¼‰ */
        background: white;
        z-index: 1000;
        transition: left 0.3s ease;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        padding-top: env(safe-area-inset-top, 0px); /* iOS å®‰å…¨å€åŸŸ */
        padding-bottom: env(safe-area-inset-bottom, 0px); /* iOS å®‰å…¨å€åŸŸ */
        overflow-y: auto;
        -webkit-overflow-scrolling: touch; /* iOS å¹³æ»‘æ»¾å‹• */
      }
      
      .mobile-drawer.open {
        left: 0;
      }
      
      .mobile-drawer-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid #e5e7eb;
        background: #f8fafc;
      }
      
      .mobile-drawer-header h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
        color: #1f2937;
      }
      
      .mobile-drawer-close {
        background: none;
        border: none;
        font-size: 20px;
        color: #6b7280;
        cursor: pointer;
        padding: 4px;
        min-width: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
        min-height: 44px;
        border-radius: 4px;
        transition: background-color 0.2s;
        -webkit-tap-highlight-color: transparent; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
        touch-action: manipulation; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
      }
      
      .mobile-drawer-close:hover {
        background-color: #e5e7eb;
      }
      
      .mobile-drawer-content {
        padding: 20px 0;
      }
      
      .mobile-drawer-item {
        display: flex;
        align-items: center;
        padding: 16px 20px;
        min-height: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
        color: #374151;
        text-decoration: none;
        transition: background-color 0.2s;
        border-left: 3px solid transparent;
        -webkit-tap-highlight-color: transparent; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
        touch-action: manipulation; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
      }
      
      .mobile-drawer-item:hover {
        background-color: #f8fafc;
        color: #1f2937;
      }
      
      .mobile-drawer-item.active {
        background-color: #eff6ff;
        color: #3b82f6;
        border-left-color: #3b82f6;
      }
      
      .mobile-drawer-icon {
        font-size: 20px;
        margin-right: 12px;
        width: 24px;
        text-align: center;
      }
      
      .mobile-drawer-text {
        font-size: 16px;
        font-weight: 500;
      }
      
      /* æ¡Œé¢ç‰ˆæ¨£å¼ - éš±è—æ‰‹æ©Ÿç‰ˆæŠ½å±œ */
      @media (min-width: 769px) {
        .mobile-drawer-toggle {
          display: none !important;
        }
        
        .mobile-drawer {
          display: none !important;
        }
        
        .mobile-drawer-overlay {
          display: none !important;
        }
      }
      
      /* éŸ¿æ‡‰å¼è¨­è¨ˆ - æ‰‹æ©Ÿç‰ˆ */
      @media (max-width: 768px) {
        .top-navbar {
          padding: 12px 16px;
          padding-top: calc(12px + env(safe-area-inset-top, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          padding-left: calc(16px + env(safe-area-inset-left, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          padding-right: calc(16px + env(safe-area-inset-right, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          flex-wrap: wrap;
          gap: 12px;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
        }
        
        .navbar-left {
          gap: 16px;
          flex: 1;
          min-width: 0;
          position: relative; /* æ·»åŠ ç›¸å°å®šä½ */
        }
        
        .navbar-title {
          font-size: 25px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          text-align: center;
          position: absolute; /* çµ•å°å®šä½ */
          left: 50%; /* æ°´å¹³ç½®ä¸­ */
          transform: translateX(-50%); /* ç²¾ç¢ºç½®ä¸­ */
          max-width: calc(100% - 80px); /* è€ƒæ…®å·¦å³æŒ‰éˆ•ç•™å‡ºç©ºé–“ */
          z-index: 1; /* ç¢ºä¿åœ¨æŒ‰éˆ•ä¹‹ä¸Š */
        }
        
        .navbar-tabs {
          display: none;
        }
        
        .navbar-right {
          gap: 8px;
        }
        
        .user-info {
          padding: 6px 12px;
          font-size: 14px;
        }
        
        .user-avatar {
          width: 28px !important;
          height: 28px !important;
        }
        
        .user-name {
          display: none; /* åœ¨æ‰‹æ©Ÿç‰ˆéš±è—ä½¿ç”¨è€…æš±ç¨± */
        }
        
        .login-btn, .logout-btn {
          padding: 10px 16px;
          min-height: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
          font-size: 14px;
          -webkit-tap-highlight-color: transparent; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
          touch-action: manipulation; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
        }
        
        .mobile-drawer-toggle {
          display: block !important;
        }
        
        .user-db-page {
          padding-top: calc(80px + env(safe-area-inset-top, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          padding-bottom: env(safe-area-inset-bottom, 0px); /* iOS å®‰å…¨å€åŸŸ */
        }
      }
      
      /* ===== å‰µä½œè€…è³‡æ–™åº«æ¨£å¼ ===== */
      .user-db-page {
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
      }
      
      .page-title {
        font-size: 24px;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 24px;
        text-align: center;
      }
      
      .user-db-container {
        display: flex;
        gap: 24px;
        min-height: 600px;
      }
      
      .user-db-sidebar {
        width: 280px;
        background: var(--bg-secondary);
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 1px 3px var(--shadow);
        transition: background-color 0.3s ease;
      }
      
      .sidebar-header {
        margin-bottom: 24px;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--border-color);
        transition: border-color 0.3s ease;
      }
      
      .user-profile {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      
      .profile-avatar {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        border: 2px solid var(--border-color);
        transition: border-color 0.3s ease;
      }
      
      .profile-info h3 {
        margin: 0 0 4px 0;
        font-size: 16px;
        font-weight: 600;
        color: var(--text-primary);
        transition: color 0.3s ease;
      }
      
      .profile-info p {
        margin: 0;
        font-size: 14px;
        color: var(--text-secondary);
        transition: color 0.3s ease;
      }
      
      .sidebar-menu {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      
      .menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        min-height: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        background: none;
        text-align: left;
        font-size: 14px;
        color: var(--text-secondary);
        -webkit-tap-highlight-color: transparent; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
        touch-action: manipulation; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
      }
      
      .menu-item:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
      }
      
      .menu-item.active {
        background: var(--button-bg);
        color: var(--button-text);
      }
      
      .menu-icon {
        font-size: 16px;
      }
      
      .menu-text {
        font-weight: 500;
      }
      
      .menu-divider {
        height: 1px;
        background: var(--border-color);
        margin: 12px 0;
        transition: background-color 0.3s ease;
      }
      
      .logout-item {
        color: #dc2626;
      }
      
      .logout-item:hover {
        background: rgba(239, 68, 68, 0.1);
        color: #dc2626;
      }
      
      .user-db-content {
        flex: 1;
        background: var(--card-bg);
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px var(--shadow);
        transition: background-color 0.3s ease;
        display: flex; /* æ¡Œé¢ç‰ˆé¡¯ç¤º */
        flex-direction: column;
      }
      
      .db-section {
        display: none;
      }
      
      .db-section.active {
        display: block;
      }
      
      /* æ¡Œé¢ç‰ˆéš±è—å½ˆè·³è¦–çª— */
      @media (min-width: 769px) {
        .userdb-modal-overlay {
          display: none !important;
        }
      }
      
      .section-title {
        font-size: 20px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 16px;
        transition: color 0.3s ease;
      }
      
      .section-content {
        color: var(--text-secondary);
        line-height: 1.6;
        transition: color 0.3s ease;
      }
      
      .profile-details {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      
      .detail-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: var(--bg-secondary);
        border-radius: 8px;
        transition: background-color 0.3s ease;
      }
      
      .detail-item label {
        font-weight: 600;
        color: var(--text-primary);
        min-width: 80px;
        transition: color 0.3s ease;
      }
      
      .detail-item span {
        color: var(--text-secondary);
        transition: color 0.3s ease;
      }
      
      .loading-text {
        text-align: center;
        padding: 40px;
        color: #6b7280;
        font-size: 14px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .spinner {
        width: 24px;
        height: 24px;
        border: 3px solid #e5e7eb;
        border-top: 3px solid #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      
      /* ===== è…³æœ¬é …ç›®æ¨£å¼ ===== */
      .script-item {
        background: #f8f9fa;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        margin-bottom: 12px;
        overflow: hidden;
      }
      
      .script-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px;
        cursor: pointer;
        background: #fff;
        border-bottom: 1px solid #e5e7eb;
        transition: background-color 0.2s;
      }
      
      .script-header:hover {
        background: #f9fafb;
      }
      
      .script-info {
        display: flex;
        align-items: center;
        gap: 16px;
        flex: 1;
      }
      
      .script-number {
        background: #3b82f6;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: bold;
        width: 60px;
        min-width: 60px;
        max-width: 60px;
        text-align: center;
        white-space: nowrap;
        display: inline-block;
        box-sizing: border-box;
      }
      
      .script-name {
        font-weight: 500;
        color: #1f2937;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 4px;
        transition: background-color 0.2s;
      }
      
      .script-name:hover {
        background: #e5e7eb;
      }
      
      .script-date {
        color: #6b7280;
        font-size: 14px;
      }
      
      .script-toggle {
        color: #6b7280;
        font-size: 14px;
      }
      
      .toggle-icon {
        transition: transform 0.2s;
      }
      
      .script-item.active .toggle-icon {
        transform: rotate(180deg);
      }
      
      .script-content {
        padding: 16px;
        background: #fff;
        border-top: 1px solid #e5e7eb;
      }
      
      .script-details {
        margin-bottom: 16px;
      }
      
      /* ===== è¡¨æ ¼æ¨£å¼ ===== */
      .script-table {
        overflow-x: auto;
        margin: 16px 0;
        border-radius: 8px;
        border: 1px solid #e5e7eb;
      }
      
      .script-table table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
        min-width: 800px;
      }
      
      .script-table th,
      .script-table td {
        border: 1px solid #e5e7eb;
        padding: 12px;
        text-align: left;
        white-space: normal;
        word-break: break-word;
        vertical-align: top;
      }
      
      .script-table th {
        background: #f8fafc;
        font-weight: 600;
        color: #374151;
        position: sticky;
        top: 0;
        z-index: 1;
      }
      
      .script-table td {
        color: #4b5563;
      }
      
      .script-table tbody tr:nth-child(even) {
        background: #f9fafb;
      }
      
      .script-table tbody tr:hover {
        background: #f3f4f6;
      }
      
      /* ===== æ“ä½œæŒ‰éˆ•æ¨£å¼ ===== */
      .script-actions {
        display: flex;
        gap: 8px;
        padding: 16px;
        background: #f8f9fa;
        border-top: 1px solid #e5e7eb;
        flex-wrap: wrap;
      }
      
      .action-btn {
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
        min-height: 40px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        white-space: nowrap;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
        user-select: none;
      }
      
      .action-btn:active {
        transform: scale(0.98);
      }
      
      .view-btn {
        background: #3b82f6;
        color: white;
      }
      
      .view-btn:hover {
        background: #2563eb;
      }
      
      .download-pdf-btn {
        background: #10b981;
        color: white;
      }
      
      .download-pdf-btn:hover {
        background: #059669;
      }
      
      .download-csv-btn {
        background: #06b6d4;
        color: white;
      }
      
      .download-csv-btn:hover {
        background: #0891b2;
      }
      
      .delete-btn {
        background: #ef4444;
        color: white;
      }
      
      .delete-btn:hover {
        background: #dc2626;
      }
      
      /* ===== å¸³è™Ÿå®šä½é …ç›®æ¨£å¼ ===== */
      .positioning-record-item {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 12px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      .record-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 2px solid #e5e7eb;
      }
      
      .record-number {
        font-weight: 600;
        color: #1f2937;
        font-size: 16px;
      }
      
      .record-date {
        color: #6b7280;
        font-size: 14px;
      }
      
      .record-preview {
        color: #4b5563;
        line-height: 1.6;
        margin-bottom: 12px;
      }
      
      .record-actions {
        display: flex;
        gap: 8px;
        margin-top: 12px;
      }
      
      /* ===== é¸é¡Œé …ç›®æ¨£å¼ ===== */
      .topic-item {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 12px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      .topic-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 2px solid #e5e7eb;
      }
      
      .topic-title {
        font-weight: 600;
        color: #1f2937;
        font-size: 16px;
      }
      
      .topic-date {
        color: #6b7280;
        font-size: 14px;
      }
      
      .topic-content {
        color: #4b5563;
        line-height: 1.6;
        margin-bottom: 12px;
      }
      
      .topic-actions {
        display: flex;
        gap: 8px;
        margin-top: 12px;
      }
      
      /* ===== IPäººè¨­è¦åŠƒé …ç›®æ¨£å¼ ===== */
      .ip-planning-item {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 12px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      .ip-planning-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 2px solid #e5e7eb;
      }
      
      .ip-planning-title {
        font-weight: 600;
        color: #1f2937;
        font-size: 16px;
      }
      
      .ip-planning-date {
        color: #6b7280;
        font-size: 14px;
      }
      
      .ip-planning-content {
        color: #4b5563;
        line-height: 1.6;
        margin-bottom: 12px;
      }
      
      /* IP è¦åŠƒçµæœä¸­çš„ Markdown è¡¨æ ¼æ¨£å¼ */
      .ip-planning-content-item table {
        width: 100%;
        border-collapse: collapse;
        margin: 16px 0;
        font-size: 14px;
        background: #ffffff;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        overflow: hidden;
      }
      
      .ip-planning-content-item table thead {
        background: #f8fafc;
        border-bottom: 2px solid #e5e7eb;
      }
      
      .ip-planning-content-item table th {
        padding: 12px 16px;
        text-align: left;
        font-weight: 600;
        color: #374151;
        white-space: nowrap;
        border-right: 1px solid #e5e7eb;
      }
      
      .ip-planning-content-item table th:last-child {
        border-right: none;
      }
      
      .ip-planning-content-item table tbody tr {
        border-bottom: 1px solid #e5e7eb;
        transition: background-color 0.2s ease;
      }
      
      .ip-planning-content-item table tbody tr:hover {
        background-color: #f9fafb;
      }
      
      .ip-planning-content-item table tbody tr:last-child {
        border-bottom: none;
      }
      
      .ip-planning-content-item table td {
        padding: 12px 16px;
        color: #4b5563;
        border-right: 1px solid #e5e7eb;
        vertical-align: top;
      }
      
      .ip-planning-content-item table td:last-child {
        border-right: none;
      }
      
      .ip-planning-content-item table tbody tr:nth-child(even) {
        background-color: #f9fafb;
      }
      
      .ip-planning-content-item table tbody tr:nth-child(even):hover {
        background-color: #f3f4f6;
      }
      
      /* éŸ¿æ‡‰å¼è¡¨æ ¼ */
      @media (max-width: 768px) {
        .ip-planning-content-item table {
          font-size: 12px;
          display: block;
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
        }
        
        .ip-planning-content-item table th,
        .ip-planning-content-item table td {
          padding: 8px 12px;
        }
      }
      
      .ip-planning-actions {
        display: flex;
        gap: 8px;
        margin-top: 12px;
      }
      
      /* iOS Safari è¼¸å…¥æ¡†å„ªåŒ– */
      input[type="text"],
      input[type="password"],
      input[type="email"],
      input[type="number"],
      textarea,
      select {
        font-size: 16px !important; /* iOS Safari å»ºè­°è‡³å°‘ 16px é¿å…è‡ªå‹•ç¸®æ”¾ */
        -webkit-appearance: none;
        appearance: none;
        -webkit-tap-highlight-color: transparent;
      }
      
      /* æ‰‹æ©Ÿç‰ˆé©é… - RWD éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media (max-width: 768px) {
        .user-db-page {
          padding: 16px;
          padding-top: calc(80px + env(safe-area-inset-top, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          padding-left: calc(16px + env(safe-area-inset-left, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          padding-right: calc(16px + env(safe-area-inset-right, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          padding-bottom: calc(16px + env(safe-area-inset-bottom, 0px)); /* iOS å®‰å…¨å€åŸŸ */
          max-width: 100%;
          overflow-x: hidden;
          box-sizing: border-box;
        }
        
        .user-db-container {
          flex-direction: column;
          max-width: 100%;
          overflow-x: hidden;
          gap: 16px; /* æ¸›å°‘é–“è· */
        }
        
        .user-db-sidebar {
          width: 100% !important;
          max-width: 100% !important;
          margin-bottom: 20px;
          border-radius: 12px;
          padding: 16px !important; /* æ¸›å°‘ padding */
          display: block !important; /* ç¢ºä¿æ‰‹æ©Ÿç‰ˆé¡¯ç¤º */
          box-sizing: border-box;
        }
        
        .user-db-content {
          display: none !important; /* æ‰‹æ©Ÿç‰ˆéš±è—å…§å®¹å€åŸŸ */
        }
        
        /* æ‰‹æ©Ÿç‰ˆé¸å–®é …ç›®å„ªåŒ– */
        .menu-item {
          padding: 14px 16px !important; /* å¢åŠ è§¸æ§ç›®æ¨™ */
          min-height: 48px !important; /* ç¢ºä¿è§¸æ§ç›®æ¨™è¶³å¤ å¤§ */
          font-size: 15px !important; /* ç¨å¾®å¢å¤§å­—é«” */
        }
        
        .menu-icon {
          font-size: 18px !important; /* å¢å¤§åœ–æ¨™ */
        }
        
        /* æ‰‹æ©Ÿç‰ˆå´é‚Šæ¬„æ¨™é¡Œå„ªåŒ– */
        .sidebar-header {
          padding-bottom: 16px !important;
          margin-bottom: 16px !important;
        }
        
        .profile-avatar {
          width: 40px !important;
          height: 40px !important;
        }
        
        .profile-info h3 {
          font-size: 15px !important;
        }
        
        .profile-info p {
          font-size: 13px !important;
        }
        
        .db-section {
          max-width: 100%;
          overflow-x: hidden;
          overflow-y: auto;
          -webkit-overflow-scrolling: touch; /* iOS å¹³æ»‘æ»¾å‹• */
        }
        
        /* æ‰‹æ©Ÿç‰ˆå½ˆè·³è¦–çª—æ¨£å¼ */
        .userdb-modal-overlay {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          width: 100% !important;
          height: 100% !important;
          height: 100dvh !important; /* iOS Safari å‹•æ…‹è¦–çª—é«˜åº¦ */
          background: rgba(0, 0, 0, 0.5) !important;
          display: none !important;
          justify-content: center !important;
          align-items: center !important;
          z-index: 99999 !important; /* æé«˜ z-index ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
          padding: 20px !important;
          box-sizing: border-box !important;
          -webkit-overflow-scrolling: touch !important;
          margin: 0 !important;
        }
        
        .userdb-modal-overlay.show {
          display: flex !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .userdb-modal-content {
          background: white;
          border-radius: 12px;
          max-width: 95%;
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
          position: relative;
          width: 100%;
          -webkit-overflow-scrolling: touch;
        }
        
        .userdb-modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 20px 24px;
          border-bottom: 1px solid #e5e7eb;
          position: sticky;
          top: 0;
          background: white;
          z-index: 1;
          border-radius: 12px 12px 0 0;
        }
        
        .userdb-modal-title {
          margin: 0;
          color: #1f2937;
          font-size: 20px;
          font-weight: 600;
        }
        
        .userdb-modal-close {
          background: none;
          border: none;
          font-size: 28px;
          cursor: pointer;
          color: #6b7280;
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 4px;
          transition: background 0.2s;
          -webkit-tap-highlight-color: transparent;
          touch-action: manipulation;
        }
        
        .userdb-modal-close:hover {
          background: #f3f4f6;
        }
        
        .userdb-modal-body {
          padding: 16px !important; /* æ‰‹æ©Ÿç‰ˆæ¸›å°‘ padding */
          overflow-y: auto;
          max-height: calc(90vh - 80px);
          -webkit-overflow-scrolling: touch;
          font-size: 14px; /* åŸºç¤å­—é«”å¤§å° */
        }
        
        .section-content {
          max-width: 100%;
          overflow-x: hidden;
          word-wrap: break-word;
          overflow-wrap: break-word; /* å„ªåŒ–æ–‡å­—æ›è¡Œ */
          -webkit-hyphens: auto; /* iOS è‡ªå‹•æ–·å­— */
          hyphens: auto;
          font-size: 14px; /* ç¢ºä¿åŸºç¤å­—é«”å¤§å° */
        }
        
        /* æ‰‹æ©Ÿç‰ˆæ¨™é¡Œå’Œæ–‡å­—å¤§å°èª¿æ•´ */
        .userdb-modal-body h2,
        .userdb-modal-body h3,
        .userdb-modal-body h4 {
          font-size: 18px !important;
          margin: 12px 0 8px 0 !important;
          line-height: 1.4 !important;
        }
        
        .userdb-modal-body h2 {
          font-size: 20px !important;
        }
        
        .userdb-modal-body p {
          font-size: 14px !important;
          line-height: 1.6 !important;
          margin: 8px 0 !important;
        }
        
        /* å€‹äººè³‡æ–™æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .profile-details {
          gap: 12px !important;
        }
        
        .userdb-modal-body .detail-item {
          padding: 12px !important;
          gap: 8px !important;
          flex-direction: column !important;
          align-items: flex-start !important;
        }
        
        .userdb-modal-body .detail-item label {
          font-size: 13px !important;
          font-weight: 600 !important;
          margin-bottom: 4px !important;
          min-width: auto !important;
        }
        
        .userdb-modal-body .detail-item span {
          font-size: 14px !important;
          word-break: break-word !important;
          width: 100% !important;
        }
        
        /* è¨­å®šå€åŸŸæ¨£å¼èª¿æ•´ */
        .userdb-modal-body .setting-group {
          margin-top: 20px !important;
        }
        
        .userdb-modal-body .setting-item {
          margin-bottom: 16px !important;
        }
        
        .userdb-modal-body .setting-desc {
          font-size: 12px !important;
          line-height: 1.5 !important;
          margin-top: 6px !important;
        }
        
        /* çµ±è¨ˆæ•¸å­—æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .stat-number {
          font-size: 28px !important;
          margin-bottom: 6px !important;
        }
        
        .userdb-modal-body .stat-label {
          font-size: 13px !important;
        }
        
        /* è…³æœ¬é …ç›®æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .script-item {
          font-size: 14px !important;
        }
        
        .userdb-modal-body .script-name {
          font-size: 14px !important;
        }
        
        .userdb-modal-body .script-date {
          font-size: 12px !important;
        }
        
        /* æŒ‰éˆ•æ¨£å¼èª¿æ•´ */
        .userdb-modal-body button {
          font-size: 14px !important;
          padding: 10px 16px !important;
        }
        
        /* åˆ—è¡¨æ¨£å¼èª¿æ•´ */
        .userdb-modal-body ul,
        .userdb-modal-body ol {
          padding-left: 20px !important;
          margin: 8px 0 !important;
        }
        
        .userdb-modal-body li {
          font-size: 14px !important;
          line-height: 1.6 !important;
          margin: 6px 0 !important;
        }
        
        /* è¡¨æ ¼å…§å®¹èª¿æ•´ */
        .userdb-modal-body table {
          font-size: 12px !important;
        }
        
        .userdb-modal-body table th,
        .userdb-modal-body table td {
          padding: 8px 6px !important;
          font-size: 12px !important;
        }
        
        /* å¹«åŠ©ä¸­å¿ƒæ¨£å¼èª¿æ•´ */
        .userdb-modal-body .help-section {
          margin-bottom: 20px !important;
        }
        
        .userdb-modal-body .help-section h4 {
          font-size: 16px !important;
          margin-bottom: 8px !important;
        }
        
        .userdb-modal-body .help-section p {
          font-size: 13px !important;
          margin-bottom: 6px !important;
        }
        
        /* æ‰‹æ©Ÿç‰ˆè¡¨æ ¼æ¨£å¼ */
        .script-table {
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
          margin: 12px 0;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }
        
        .script-table table {
          min-width: 800px;
          font-size: 11px;
          margin: 0;
        }
        
        .script-table th,
        .script-table td {
          padding: 10px 8px;
          white-space: normal;
          word-break: break-word;
          vertical-align: top;
        }
        
        .script-table th {
          font-size: 11px;
          font-weight: 600;
          background: #f8fafc;
          position: sticky;
          left: 0;
          z-index: 1;
        }
        
        .script-table td:first-child {
          position: sticky;
          left: 0;
          background: white;
          z-index: 1;
          font-weight: 500;
        }
        
        .script-table tbody tr:nth-child(even) td:first-child {
          background: #f9fafb;
        }
        
        .script-actions {
          flex-direction: column;
          gap: 10px;
          padding: 12px;
          background: #f8fafc;
          border-top: 1px solid #e5e7eb;
        }
        
        .action-btn {
          padding: 12px 16px;
          min-height: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
          font-size: 14px;
          width: 100%;
          -webkit-tap-highlight-color: transparent; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
          touch-action: manipulation; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
        }
        
        .script-item {
          margin-bottom: 16px;
          border-radius: 12px;
        }
        
        .script-header {
          padding: 12px 16px;
          flex-wrap: wrap;
          gap: 8px;
        }
        
        .script-info {
          flex-direction: column;
          align-items: flex-start;
          gap: 8px;
          width: 100%;
        }
        
        .positioning-record-item,
        .topic-item,
        .ip-planning-item {
          padding: 12px !important;
          margin-bottom: 16px !important;
          font-size: 14px !important;
        }
        
        .userdb-modal-body .positioning-record-item h4,
        .userdb-modal-body .topic-item h4,
        .userdb-modal-body .ip-planning-item h4 {
          font-size: 16px !important;
          margin: 0 0 8px 0 !important;
          font-weight: 600 !important;
        }
        
        .userdb-modal-body .positioning-record-item p,
        .userdb-modal-body .topic-item p,
        .userdb-modal-body .ip-planning-item p {
          font-size: 13px !important;
          line-height: 1.6 !important;
          margin: 6px 0 !important;
        }
        
        .userdb-modal-body .positioning-record-item .record-meta,
        .userdb-modal-body .topic-item .topic-meta,
        .userdb-modal-body .ip-planning-item .ip-planning-meta {
          font-size: 12px !important;
          color: #6b7280 !important;
          margin-top: 8px !important;
        }
        
        .record-actions,
        .topic-item-actions,
        .ip-planning-actions {
          flex-direction: column !important;
          gap: 8px !important;
          margin-top: 12px !important;
        }
        
        .record-actions .action-btn,
        .topic-item-actions .action-btn,
        .ip-planning-actions .action-btn {
          width: 100% !important;
          padding: 12px 16px !important;
          min-height: 44px !important; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
          font-size: 14px !important;
          -webkit-tap-highlight-color: transparent !important; /* ç§»é™¤ iOS é»æ“Šé«˜äº® */
          touch-action: manipulation !important; /* å„ªåŒ–è§¸æ§éŸ¿æ‡‰ */
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          user-select: none !important;
        }
        
        .record-actions .action-btn:active,
        .topic-item-actions .action-btn:active,
        .ip-planning-actions .action-btn:active {
          transform: scale(0.97) !important;
          opacity: 0.9 !important;
        }
        
        /* IPäººè¨­è¦åŠƒåˆ—è¡¨é …ç›®æ‰‹æ©Ÿç‰ˆå¸ƒå±€åˆ‡æ› */
        .ip-planning-header-mobile {
          display: flex !important;
        }
        
        .ip-planning-header-desktop {
          display: none !important;
        }
        
        .ip-planning-actions-mobile {
          display: flex !important;
        }
        
        .ip-planning-actions-desktop {
          display: none !important;
        }
        
        /* ç¢ºä¿ IPäººè¨­è¦åŠƒåˆ—è¡¨é …ç›®ä¸æ°´å¹³æº¢å‡º */
        .ip-planning-item {
          width: 100% !important;
          max-width: 100% !important;
          padding: 16px !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          box-sizing: border-box !important;
          overflow-x: hidden !important;
        }
        
        .ip-planning-header-mobile,
        .ip-planning-header-desktop {
          width: 100% !important;
          max-width: 100% !important;
          overflow-x: hidden !important;
          box-sizing: border-box !important;
          flex-wrap: wrap !important;
        }
        
        .ip-planning-item-title {
          max-width: 100% !important;
          word-break: break-word !important;
          overflow-wrap: break-word !important;
          white-space: normal !important;
        }
        
        .ip-planning-content-item {
          width: 100% !important;
          max-width: 100% !important;
          overflow-x: hidden !important;
          overflow-y: auto !important;
          box-sizing: border-box !important;
          word-wrap: break-word !important;
          overflow-wrap: break-word !important;
        }
        
        .ip-planning-actions-mobile {
          width: 100% !important;
          max-width: 100% !important;
          overflow-x: hidden !important;
          box-sizing: border-box !important;
          flex-wrap: wrap !important;
          gap: 8px !important;
        }
        
        .ip-planning-actions-mobile .action-btn {
          box-sizing: border-box !important;
          max-width: 100% !important;
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
        }
        
        /* IPäººè¨­è¦åŠƒå½ˆè·³è¦–çª—æ‰‹æ©Ÿç‰ˆå„ªåŒ– */
        .ip-planning-detail-modal-overlay {
          padding: 0 !important;
          align-items: flex-end !important;
        }
        
        .ip-planning-detail-modal-overlay > div {
          max-width: 100% !important;
          width: 100% !important;
          max-height: 90vh !important;
          border-radius: 16px 16px 0 0 !important;
          margin: 0 !important;
        }
        
        /* å½ˆè·³è¦–çª—å…§å®¹å€åŸŸï¼šä¸æ°´å¹³æº¢å‡ºï¼ˆé™¤äº†è¡¨æ ¼ï¼‰ */
        .ip-planning-detail-modal-overlay > div > div:nth-child(2) {
          padding: 16px !important;
          font-size: 14px !important;
          overflow-x: hidden !important;
          overflow-y: auto !important;
          width: 100% !important;
          max-width: 100% !important;
          box-sizing: border-box !important;
          word-wrap: break-word !important;
          overflow-wrap: break-word !important;
        }
        
        .ip-planning-detail-modal-overlay > div > div:nth-child(2) > div:last-child {
          font-size: 14px !important;
          line-height: 1.6 !important;
          word-break: break-word !important;
          overflow-wrap: break-word !important;
        }
        
        /* åˆ—è¡¨é …ç›®ä¸­çš„è¡¨æ ¼ï¼šå¯ä»¥æ°´å¹³æ»¾å‹•ï¼ˆé è¦½ç”¨ï¼‰ */
        .ip-planning-content-item table {
          font-size: 12px !important;
          display: block !important;
          overflow-x: auto !important;
          -webkit-overflow-scrolling: touch !important;
          width: 100% !important;
          max-width: 100% !important;
          margin: 0 !important;
        }
        
        /* å½ˆè·³è¦–çª—ä¸­çš„è¡¨æ ¼ï¼šå¯ä»¥æ°´å¹³æ»¾å‹•ï¼ˆé€™æ˜¯å”¯ä¸€å…è¨±æ°´å¹³æ»¾å‹•çš„åœ°æ–¹ï¼‰ */
        .ip-planning-detail-modal-overlay table,
        .userdb-modal-body table {
          font-size: 12px !important;
          display: block !important;
          overflow-x: auto !important;
          -webkit-overflow-scrolling: touch !important;
          width: 100% !important;
          max-width: 100% !important;
          margin: 12px 0 !important;
        }
        
        /* ç¢ºä¿æ‰€æœ‰æ–‡å­—å…§å®¹æ­£ç¢ºæ›è¡Œ */
        .ip-planning-item *,
        .ip-planning-content-item * {
          max-width: 100% !important;
          word-wrap: break-word !important;
          overflow-wrap: break-word !important;
        }
        
        /* é™¤äº†è¡¨æ ¼ï¼Œå…¶ä»–å…ƒç´ éƒ½ä¸å…è¨±æ°´å¹³æ»¾å‹• */
        .ip-planning-item *:not(table),
        .ip-planning-content-item *:not(table) {
          overflow-x: hidden !important;
        }
        
        /* æ¡Œé¢ç‰ˆä¿æŒåŸæ¨£ */
        @media (min-width: 769px) {
          .ip-planning-header-mobile {
            display: none !important;
          }
          
          .ip-planning-header-desktop {
            display: flex !important;
          }
          
          .ip-planning-actions-mobile {
            display: none !important;
          }
          
          .ip-planning-actions-desktop {
            display: flex !important;
          }
        }
        
        /* è¨‚å–®é …ç›®æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .order-item {
          padding: 12px !important;
          margin-bottom: 12px !important;
          font-size: 14px !important;
        }
        
        .userdb-modal-body .order-item .order-id {
          font-size: 13px !important;
          font-weight: 600 !important;
        }
        
        .userdb-modal-body .order-item .order-date,
        .userdb-modal-body .order-item .order-amount {
          font-size: 12px !important;
          color: #6b7280 !important;
        }
        
        /* å°è©±è¨˜éŒ„æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .conversation-item {
          padding: 12px !important;
          margin-bottom: 12px !important;
          font-size: 14px !important;
        }
        
        .userdb-modal-body .conversation-item .conversation-preview {
          font-size: 13px !important;
          line-height: 1.5 !important;
        }
        
        /* é€šç”¨æ–‡å­—æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .text-sm {
          font-size: 12px !important;
        }
        
        .userdb-modal-body .text-base {
          font-size: 14px !important;
        }
        
        .userdb-modal-body .text-lg {
          font-size: 16px !important;
        }
        
        /* æ¨™ç±¤å’Œå¾½ç« æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .badge,
        .userdb-modal-body .tag {
          font-size: 11px !important;
          padding: 4px 8px !important;
        }
        
        /* åˆ†éš”ç·šæ¨£å¼ */
        .userdb-modal-body hr {
          margin: 12px 0 !important;
        }
        
        /* å¡ç‰‡æ¨£å¼èª¿æ•´ */
        .userdb-modal-body .card {
          padding: 12px !important;
          margin-bottom: 12px !important;
        }
        
        /* ç¢ºä¿æ‰€æœ‰æ–‡å­—éƒ½èƒ½æ­£ç¢ºæ›è¡Œ */
        .userdb-modal-body * {
          max-width: 100% !important;
          box-sizing: border-box !important;
        }
        
        /* æ‰‹æ©Ÿç‰ˆè¼¸å…¥æ¡†å’Œé¸æ“‡æ¡†å„ªåŒ– */
        input[type="text"],
        input[type="password"],
        input[type="email"],
        input[type="number"],
        textarea,
        select {
          min-height: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
          padding: 12px 16px !important;
          font-size: 16px !important; /* iOS Safari å»ºè­°è‡³å°‘ 16px */
          border-radius: 8px;
          -webkit-appearance: none;
          appearance: none;
        }
        
        /* æ‰‹æ©Ÿç‰ˆæŒ‰éˆ•å„ªåŒ– */
        button {
          min-height: 44px; /* iOS æœ€å°è§¸æ§ç›®æ¨™ */
          -webkit-tap-highlight-color: transparent;
          touch-action: manipulation;
        }
        
        /* æ‰‹æ©Ÿç‰ˆé€£çµå„ªåŒ– */
        a {
          -webkit-tap-highlight-color: transparent;
          touch-action: manipulation;
        }
      }
    </style>
  </head>
  <body>
    <!-- å°èˆªæ¬„ -->
    <div class="top-navbar">
      <div class="navbar-left">
        <!-- æ‰‹æ©Ÿç‰ˆæŠ½å±œæŒ‰éˆ• -->
        <button class="mobile-drawer-toggle" onclick="toggleMobileDrawer()">
          <span class="hamburger-icon">â˜°</span>
        </button>
        <div class="navbar-title clickable-title" onclick="window.location.href='index.html'">ReelMind</div>
        <div class="navbar-tabs">
          <a href="index.html" class="navbar-tab">é¦–é </a>
          <a href="mode1.html" class="navbar-tab">IPäººè¨­è¦åŠƒ</a>
          <a href="mode3.html" class="navbar-tab">ä¸€éµç”Ÿæˆ</a>
          <a href="index.html#forum" class="navbar-tab" onclick="event.preventDefault(); window.location.href='index.html#forum'; return false;">è«–å£‡ä»‹ç´¹</a>
          <a href="guide.html" class="navbar-tab">å¯¦æˆ°æŒ‡å—</a>
          <a href="userDB.html" class="navbar-tab active">å‰µä½œè€…è³‡æ–™åº«</a>
        </div>
      </div>
      <div class="navbar-right">
        <div class="user-info" id="userInfo" style="display: none;" onclick="window.location.href='userDB.html'">
          <img id="userAvatar" class="user-avatar" src="" alt="ç”¨æˆ¶é ­åƒ" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover; object-position: center;">
          <span id="userName" class="user-name"></span>
        </div>
        <div class="auth-buttons" id="authButtons" style="display: none;">
          <button id="loginBtn" class="login-btn" onclick="goToLogin()" style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ğŸ” ç™»å…¥</button>
        </div>
      </div>
    </div>

    <!-- æ‰‹æ©Ÿç‰ˆæŠ½å±œ -->
    <div class="mobile-drawer-overlay" id="mobileDrawerOverlay" onclick="closeMobileDrawer()"></div>
    <div class="mobile-drawer" id="mobileDrawer">
      <div class="mobile-drawer-header">
        <h3>é¸å–®</h3>
        <button class="mobile-drawer-close" onclick="closeMobileDrawer()">âœ•</button>
      </div>
      <div class="mobile-drawer-content">
        <a href="index.html" class="mobile-drawer-item">
          <span class="mobile-drawer-icon"><i class="fas fa-home"></i></span>
          <span class="mobile-drawer-text">é¦–é </span>
        </a>
        <a href="mode1.html" class="mobile-drawer-item">
          <span class="mobile-drawer-icon"><i class="fas fa-user-tie"></i></span>
          <span class="mobile-drawer-text">IPäººè¨­è¦åŠƒ</span>
        </a>
        <a href="mode3.html" class="mobile-drawer-item">
          <span class="mobile-drawer-icon"><i class="fas fa-magic"></i></span>
          <span class="mobile-drawer-text">ä¸€éµç”Ÿæˆ</span>
        </a>
        <a href="index.html#forum" class="mobile-drawer-item" onclick="window.location.href='index.html#forum'; closeMobileDrawer(); return false;">
          <span class="mobile-drawer-icon"><i class="fas fa-comments"></i></span>
          <span class="mobile-drawer-text">è«–å£‡ä»‹ç´¹</span>
        </a>
        <a href="guide.html" class="mobile-drawer-item" onclick="window.location.href='guide.html'; closeMobileDrawer(); return false;">
          <span class="mobile-drawer-icon"><i class="fas fa-book-open"></i></span>
          <span class="mobile-drawer-text">å¯¦æˆ°æŒ‡å—</span>
        </a>
        <a href="userDB.html" class="mobile-drawer-item active">
          <span class="mobile-drawer-icon"><i class="fas fa-database"></i></span>
          <span class="mobile-drawer-text">å‰µä½œè€…è³‡æ–™åº«</span>
        </a>
      </div>
    </div>

    <!-- å‰µä½œè€…è³‡æ–™åº«é é¢ -->
    <div class="user-db-page">
      <h2 class="page-title"><i class="fas fa-database" style="margin-right: 8px;"></i>å‰µä½œè€…è³‡æ–™åº«</h2>
      <div class="user-db-container">
        <!-- å·¦å´åŠŸèƒ½é¸å–® -->
        <div class="user-db-sidebar">
          <div class="sidebar-header">
            <div class="user-profile">
              <img id="dbUserAvatar" class="profile-avatar" src="" alt="ç”¨æˆ¶é ­åƒ">
              <div class="profile-info">
                <h3 id="dbUserName">ç”¨æˆ¶åç¨±</h3>
                <p id="dbUserEmail">user@example.com</p>
              </div>
            </div>
          </div>
          <nav class="sidebar-menu">
            <div class="menu-item active" onclick="handleMenuClick('personalInfo')">
              <span class="menu-icon"><i class="fas fa-user"></i></span>
              <span class="menu-text">å€‹äººè³‡æ–™</span>
            </div>
            <div class="menu-item" id="menu-ipPlanning" onclick="handleMenuClick('ipPlanning')" style="display: none;">
              <span class="menu-icon"><i class="fas fa-user-tie"></i></span>
              <span class="menu-text">IPäººè¨­è¦åŠƒ</span>
            </div>
            <div class="menu-item" onclick="handleMenuClick('oneClickGeneration')">
              <span class="menu-icon"><i class="fas fa-bolt"></i></span>
              <span class="menu-text">ä¸€éµç”Ÿæˆ</span>
            </div>
            <div class="menu-item" onclick="handleMenuClick('myOrders')">
              <span class="menu-icon"><i class="fas fa-credit-card"></i></span>
              <span class="menu-text">æˆ‘çš„è¨‚å–®</span>
            </div>
            <div class="menu-item" onclick="handleMenuClick('settings')">
              <span class="menu-icon"><i class="fas fa-cog"></i></span>
              <span class="menu-text">è¨­å®š</span>
            </div>
            <div class="menu-item" onclick="handleMenuClick('usageStats')">
              <span class="menu-icon"><i class="fas fa-chart-bar"></i></span>
              <span class="menu-text">ä½¿ç”¨çµ±è¨ˆ</span>
            </div>
            <div class="menu-item" onclick="handleMenuClick('helpCenter')">
              <span class="menu-icon"><i class="fas fa-question-circle"></i></span>
              <span class="menu-text">å¹«åŠ©ä¸­å¿ƒ</span>
            </div>
            <div class="menu-divider"></div>
            <div class="menu-item logout-item" onclick="logout()">
              <span class="menu-icon"><i class="fas fa-sign-out-alt"></i></span>
              <span class="menu-text">ç™»å‡º</span>
            </div>
          </nav>
        </div>
        <!-- æ‰‹æ©Ÿç‰ˆå½ˆè·³è¦–çª— -->
        <div class="userdb-modal-overlay" id="userdbModalOverlay">
          <div class="userdb-modal-content" onclick="event.stopPropagation();">
            <div class="userdb-modal-header">
              <h3 class="userdb-modal-title" id="userdbModalTitle">æ¨™é¡Œ</h3>
              <button class="userdb-modal-close" onclick="closeUserDbModal()">Ã—</button>
            </div>
            <div class="userdb-modal-body" id="userdbModalBody">
              <p>è¼‰å…¥ä¸­...</p>
            </div>
          </div>
        </div>
        
        <!-- å³å´å…§å®¹å€åŸŸ -->
        <div class="user-db-content">
          <!-- å€‹äººè³‡æ–™ -->
          <div id="db-personalInfo" class="db-section active">
            <h3 class="section-title"><i class="fas fa-user" style="margin-right: 8px;"></i>å€‹äººè³‡æ–™</h3>
            <div class="section-content">
              <p>è¼‰å…¥ä¸­...</p>
            </div>
          </div>
          <!-- IPäººè¨­è¦åŠƒ -->
          <div id="db-ipPlanning" class="db-section" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; gap: 12px;">
              <h3 class="section-title"><i class="fas fa-user-tie" style="margin-right: 8px;"></i>IPäººè¨­è¦åŠƒ</h3>
              <button onclick="exportIpPlanningResults()" style="padding: 10px 16px; min-height: 44px; background: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; font-weight: 500; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"><i class="fas fa-download" style="margin-right: 4px;"></i>åŒ¯å‡º</button>
            </div>
            <div class="section-content">
              <div class="ip-planning-tabs" style="display: flex; gap: 8px; margin-bottom: 20px; border-bottom: 2px solid #E5E7EB;">
                <button class="ip-planning-tab active" onclick="showIpPlanningType('profile')" style="padding: 10px 16px; min-height: 44px; border: none; background: transparent; cursor: pointer; border-bottom: 2px solid #3B82F6; color: #3B82F6; font-weight: 600; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">å¸³è™Ÿå®šä½</button>
                <button class="ip-planning-tab" onclick="showIpPlanningType('plan')" style="padding: 10px 16px; min-height: 44px; border: none; background: transparent; cursor: pointer; color: #6B7280; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">é¸é¡Œæ–¹å‘ï¼ˆå½±ç‰‡é¡å‹é…æ¯”ï¼‰</button>
                <button class="ip-planning-tab" onclick="showIpPlanningType('scripts')" style="padding: 10px 16px; min-height: 44px; border: none; background: transparent; cursor: pointer; color: #6B7280; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">ä¸€é€±è…³æœ¬</button>
              </div>
              <div id="ip-planning-content" class="ip-planning-content">
                <div class="loading-text">è¼‰å…¥ä¸­...</div>
              </div>
            </div>
          </div>
          <!-- ä¸€éµç”Ÿæˆ -->
          <div id="db-oneClickGeneration" class="db-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; gap: 12px;">
              <h3 class="section-title"><i class="fas fa-bolt" style="margin-right: 8px;"></i>ä¸€éµç”Ÿæˆ</h3>
              <button onclick="exportOneClickGenerationResults()" style="padding: 10px 16px; min-height: 44px; background: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; font-weight: 500; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"><i class="fas fa-download" style="margin-right: 4px;"></i>åŒ¯å‡º</button>
            </div>
            <div class="section-content">
              <div class="one-click-tabs" style="display: flex; gap: 8px; margin-bottom: 20px; border-bottom: 2px solid #E5E7EB;">
                <button class="one-click-tab active" onclick="showOneClickType('profile')" style="padding: 10px 16px; min-height: 44px; border: none; background: transparent; cursor: pointer; border-bottom: 2px solid #3B82F6; color: #3B82F6; font-weight: 600; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">å¸³è™Ÿå®šä½</button>
                <button class="one-click-tab" onclick="showOneClickType('plan')" style="padding: 10px 16px; min-height: 44px; border: none; background: transparent; cursor: pointer; color: #6B7280; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">é¸é¡Œæ–¹å‘</button>
                <button class="one-click-tab" onclick="showOneClickType('scripts')" style="padding: 10px 16px; min-height: 44px; border: none; background: transparent; cursor: pointer; color: #6B7280; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">è…³æœ¬</button>
              </div>
              <div id="one-click-content" class="one-click-content">
                <div class="loading-text">è¼‰å…¥ä¸­...</div>
              </div>
            </div>
          </div>
          <!-- æˆ‘çš„è¨‚å–® -->
          <div id="db-myOrders" class="db-section">
            <h3 class="section-title"><i class="fas fa-credit-card" style="margin-right: 8px;"></i>æˆ‘çš„è¨‚å–®</h3>
            <div class="section-content" id="myOrdersContent">
              <div class="loading-text">è¼‰å…¥ä¸­...</div>
            </div>
          </div>
          <!-- è¨­å®š -->
          <div id="db-settings" class="db-section">
            <h3 class="section-title"><i class="fas fa-cog" style="margin-right: 8px;"></i>è¨­å®š</h3>
            <div class="section-content" id="settingsContent">
              <div class="settings-container">
                <!-- BYOK èªªæ˜ -->
                <div class="byok-notice" style="margin-bottom: 24px; padding: 16px; background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px;">
                  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <i class="fas fa-key" style="font-size: 24px; color: #0369a1;"></i>
                    <h4 style="margin: 0; color: #0369a1; font-size: 16px; font-weight: 600;">AI API Keyé‡‘é‘°ç®¡ç†</h4>
                  </div>
                  <p style="margin: 0; color: #0c4a6e; font-size: 14px; line-height: 1.6;">
                    ä½¿ç”¨æ‚¨è‡ªå·±çš„ API é‡‘é‘°å¯ä»¥ç²å¾—æ›´é«˜çš„ä½¿ç”¨é¡åº¦å’Œæ›´ç©©å®šçš„æœå‹™
                  </p>
                </div>
                
                <div class="setting-group">
                  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                    <h4 style="margin: 0;"><i class="fas fa-key" style="margin-right: 8px;"></i>AI API Keyé‡‘é‘°ç®¡ç†</h4>
                    <button onclick="window.location.href='https://reelmind.aijob.com.tw/guide.html?article=article5'; return false;" style="
                      padding: 8px 16px;
                      background: #3b82f6;
                      color: white;
                      border: none;
                      border-radius: 6px;
                      font-weight: 600;
                      cursor: pointer;
                      font-size: 14px;
                      display: inline-flex;
                      align-items: center;
                      gap: 6px;
                      -webkit-tap-highlight-color: transparent;
                      touch-action: manipulation;
                    ">
                      <i class="fas fa-question-circle"></i>
                      å¦‚ä½•å–å¾—
                    </button>
                  </div>
                  <div class="setting-item">
                    <label for="llmProvider">é¸æ“‡å¤§å‹èªè¨€æ¨¡å‹(LLM) æä¾›å•†</label>
                    <select id="llmProvider" onchange="updateModelOptions()" style="margin-bottom: 12px; padding: 12px 16px; min-height: 44px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 16px; width: 100%; -webkit-appearance: none; appearance: none;">
                      <option value="gemini">Google Gemini</option>
                      <option value="openai">OpenAI (GPT)</option>
                    </select>
                  </div>
                  <div class="setting-item" id="llmModelContainer">
                    <label for="llmModel">é¸æ“‡æ¨¡å‹ï¼ˆå¯é¸ï¼Œç•™ç©ºå‰‡ä½¿ç”¨ç³»çµ±é è¨­ï¼‰</label>
                    <select id="llmModel" style="margin-bottom: 12px; padding: 12px 16px; min-height: 44px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 16px; width: 100%; -webkit-appearance: none; appearance: none;">
                      <option value="">è«‹å…ˆé¸æ“‡æä¾›å•†...</option>
                    </select>
                    <span class="setting-desc" style="margin-top: 8px; display: block; color: #6b7280; font-size: 12px;">
                      é¸æ“‡æ‚¨æƒ³è¦ä½¿ç”¨çš„æ¨¡å‹ã€‚å¦‚æœç•™ç©ºï¼Œç³»çµ±å°‡ä½¿ç”¨é è¨­æ¨¡å‹ã€‚
                    </span>
                  </div>
                  <div class="setting-item" id="llmKeyContainer">
                    <label for="llmApiKey">API é‡‘é‘°</label>
                    <div style="display: flex; gap: 8px; align-items: center;">
                      <input 
                        type="password" 
                        id="llmApiKey" 
                        placeholder="è¼¸å…¥æ‚¨çš„ API é‡‘é‘°"
                        style="flex: 1; padding: 12px 16px; min-height: 44px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 16px; -webkit-appearance: none; appearance: none;"
                      />
                      <button 
                        type="button" 
                        onclick="toggleApiKeyVisibility()"
                        style="padding: 10px 12px; min-height: 44px; min-width: 44px; background: #f3f4f6; border: 1px solid #e5e7eb; border-radius: 6px; cursor: pointer; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"
                      >
                        <i class="fas fa-eye" id="toggleKeyIcon"></i>
                      </button>
                    </div>
                    <div id="savedKeyDisplay" style="display: none; margin-top: 8px;">
                      <span style="color: #6b7280; font-size: 12px;">å·²ä¿å­˜çš„é‡‘é‘°: <span id="savedKeyLast4"></span></span>
                      <button 
                        type="button" 
                        onclick="clearSavedApiKey()"
                        style="margin-left: 8px; padding: 8px 12px; min-height: 44px; font-size: 14px; color: #ef4444; background: none; border: none; cursor: pointer; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"
                      >
                        æ¸…é™¤
                      </button>
                    </div>
                    <span class="setting-desc" style="margin-top: 8px; display: block; color: #6b7280; font-size: 12px;">
                      æ‚¨çš„ API é‡‘é‘°å°‡ä»¥åŠ å¯†æ–¹å¼å®‰å…¨å­˜å„²åœ¨ä¼ºæœå™¨ä¸Šï¼Œåƒ…ç”¨æ–¼ç”Ÿæˆ AI å…§å®¹
                    </span>
                  </div>
                  <div class="setting-item">
                    <button onclick="saveApiKey()" style="margin-right: 8px; padding: 10px 16px; min-height: 44px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"><i class="fas fa-save" style="margin-right: 4px;"></i>ä¿å­˜é‡‘é‘°</button>
                    <button onclick="testApiKey()" style="padding: 10px 16px; min-height: 44px; background: #f3f4f6; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; cursor: pointer; font-weight: 500; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"><i class="fas fa-vial" style="margin-right: 4px;"></i>æ¸¬è©¦é‡‘é‘°</button>
                    <span class="setting-desc" style="display: block; margin-top: 8px; color: #6b7280; font-size: 12px;">
                      ä¿å­˜å‰å»ºè­°å…ˆæ¸¬è©¦é‡‘é‘°æ˜¯å¦æœ‰æ•ˆ
                    </span>
                    <div id="testKeyResult" style="display: none; margin-top: 12px; padding: 12px; border-radius: 6px; font-size: 14px;"></div>
                  </div>
                </div>
                
                <div class="setting-group" style="margin-top: 32px;">
                  <h4><i class="fas fa-chart-bar" style="margin-right: 8px;"></i>æ•¸æ“šç®¡ç†</h4>
                  <div class="setting-item">
                    <button onclick="exportUserData()" style="padding: 10px 16px; min-height: 44px; background: #f3f4f6; color: #374151; border: 1px solid #e5e7eb; border-radius: 6px; cursor: pointer; font-weight: 500; margin-bottom: 8px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"><i class="fas fa-download" style="margin-right: 4px;"></i>åŒ¯å‡ºæˆ‘çš„è³‡æ–™</button>
                    <span class="setting-desc" style="display: block; color: #6b7280; font-size: 12px;">åŒ¯å‡ºæ‰€æœ‰è…³æœ¬ã€å°è©±ã€å®šä½è¨˜éŒ„ç‚º Excel æª”æ¡ˆï¼ˆä¸åŒåŠŸèƒ½åˆ†ä¸åŒåˆ†é ï¼‰</span>
                  </div>
                  <div class="setting-item">
                    <button onclick="clearUserData()" style="padding: 10px 16px; min-height: 44px; background: #fee2e2; color: #991b1b; border: 1px solid #fca5a5; border-radius: 6px; cursor: pointer; font-weight: 500; margin-bottom: 8px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"><i class="fas fa-trash-alt" style="margin-right: 4px;"></i>æ¸…é™¤æœ¬åœ°å¿«å–</button>
                    <span class="setting-desc" style="display: block; color: #6b7280; font-size: 12px;">æ¸…é™¤æœ¬åœ°æš«å­˜æ•¸æ“š</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- ä½¿ç”¨çµ±è¨ˆ -->
          <div id="db-usageStats" class="db-section">
            <h3 class="section-title"><i class="fas fa-chart-bar" style="margin-right: 8px;"></i>ä½¿ç”¨çµ±è¨ˆ</h3>
            <div class="section-content" id="usageStatsContent">
              <div class="stats-overview" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 24px;">
                <div class="stat-card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center;">
                  <div class="stat-number" id="totalScripts" style="font-size: 32px; font-weight: 700; color: #3b82f6; margin-bottom: 8px;">0</div>
                  <div class="stat-label" style="color: #6b7280; font-size: 14px;">å·²ç”Ÿæˆè…³æœ¬</div>
                </div>
                <div class="stat-card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center;">
                  <div class="stat-number" id="totalPositioning" style="font-size: 32px; font-weight: 700; color: #10b981; margin-bottom: 8px;">0</div>
                  <div class="stat-label" style="color: #6b7280; font-size: 14px;">å¸³è™Ÿå®šä½è¨˜éŒ„</div>
                </div>
                <div class="stat-card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center;">
                  <div class="stat-number" id="totalTopics" style="font-size: 32px; font-weight: 700; color: #f59e0b; margin-bottom: 8px;">0</div>
                  <div class="stat-label" style="color: #6b7280; font-size: 14px;">é¸é¡Œè¨˜éŒ„</div>
                </div>
                <div class="stat-card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center;">
                  <div class="stat-number" id="totalConversations" style="font-size: 32px; font-weight: 700; color: #8b5cf6; margin-bottom: 8px;">0</div>
                  <div class="stat-label" style="color: #6b7280; font-size: 14px;">å°è©±æ¬¡æ•¸</div>
                </div>
              </div>
              <div class="stats-chart" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <canvas id="usageChart"></canvas>
              </div>
            </div>
          </div>
          <!-- å¹«åŠ©ä¸­å¿ƒ -->
          <div id="db-helpCenter" class="db-section">
            <h3 class="section-title"><i class="fas fa-question-circle" style="margin-right: 8px;"></i>å¹«åŠ©ä¸­å¿ƒ</h3>
            <div class="section-content" id="helpContent">
              <div class="help-container">
                <div class="help-section" style="margin-bottom: 24px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                  <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 18px; font-weight: 600;"><i class="fas fa-rocket" style="margin-right: 8px;"></i>å¿«é€Ÿé–‹å§‹</h4>
                  <ul style="margin: 0; padding-left: 20px; color: #374151; line-height: 1.8;">
                    <li>é¦–æ¬¡ä½¿ç”¨å»ºè­°å…ˆå˜—è©¦ã€Œä¸€éµç”Ÿæˆã€åŠŸèƒ½</li>
                    <li>é»æ“Šã€Œé–‹å§‹ã€æŒ‰éˆ•å³å¯ç”Ÿæˆå¸³è™Ÿå®šä½ã€é¸é¡Œã€è…³æœ¬</li>
                    <li>æ‰€æœ‰ç”Ÿæˆå…§å®¹æœƒè‡ªå‹•ä¿å­˜åˆ°ã€Œæˆ‘çš„è…³æœ¬ã€</li>
                  </ul>
                </div>
                <div class="help-section" style="margin-bottom: 24px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                  <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 18px; font-weight: 600;"><i class="fas fa-list" style="margin-right: 8px;"></i>ä¸‰å¤§ä½¿ç”¨æ¨¡å¼</h4>
                  <ul style="margin: 0; padding-left: 20px; color: #374151; line-height: 1.8;">
                    <li><strong>ä¸€éµç”Ÿæˆï¼š</strong>å¿«é€Ÿç”Ÿæˆå®šä½ã€é¸é¡Œã€è…³æœ¬</li>
                    <li><strong>IPäººè¨­è¦åŠƒï¼š</strong>14å¤©è¦åŠƒèˆ‡å€‹äººåŒ–è³‡æ–™åº«</li>
                  </ul>
                </div>
                <div class="help-section" style="margin-bottom: 24px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                  <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 18px; font-weight: 600;"><i class="fas fa-database" style="margin-right: 8px;"></i>è³‡æ–™åº«åŠŸèƒ½</h4>
                  <ul style="margin: 0; padding-left: 20px; color: #374151; line-height: 1.8;">
                    <li>æ‰€æœ‰ç”Ÿæˆå…§å®¹è‡ªå‹•ä¿å­˜</li>
                    <li>å¯åœ¨ã€Œå‰µä½œè€…è³‡æ–™åº«ã€æŸ¥çœ‹æ­·å²è¨˜éŒ„</li>
                    <li>æ”¯æŒé‡å‘½åã€åˆªé™¤ã€æŸ¥çœ‹è©³æƒ…</li>
                  </ul>
                </div>
                <div class="help-section" style="margin-bottom: 24px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                  <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 18px; font-weight: 600;"><i class="fas fa-question-circle" style="margin-right: 8px;"></i>å¸¸è¦‹å•é¡Œ</h4>
                  <div class="faq-item" style="margin-bottom: 16px;">
                    <strong style="display: block; margin-bottom: 4px; color: #1f2937;">Q: å¦‚ä½•ä¿å­˜è…³æœ¬ï¼Ÿ</strong>
                    <p style="margin: 0; color: #6b7280;">A: é»æ“Šç”Ÿæˆçµæœå³ä¸Šè§’çš„ã€Œä¿å­˜ã€æŒ‰éˆ•å³å¯ã€‚</p>
                  </div>
                  <div class="faq-item" style="margin-bottom: 16px;">
                    <strong style="display: block; margin-bottom: 4px; color: #1f2937;">Q: å¯ä»¥åŒ¯å‡ºè³‡æ–™å—ï¼Ÿ</strong>
                    <p style="margin: 0; color: #6b7280;">A: å¯ä»¥ï¼Œåœ¨ã€Œè¨­å®šã€â†’ã€Œè³‡æ–™ç®¡ç†ã€ä¸­é¸æ“‡åŒ¯å‡ºã€‚</p>
                  </div>
                  <div class="faq-item">
                    <strong style="display: block; margin-bottom: 4px; color: #1f2937;">Q: å¦‚ä½•åˆªé™¤è¨˜éŒ„ï¼Ÿ</strong>
                    <p style="margin: 0; color: #6b7280;">A: åœ¨ã€Œå‰µä½œè€…è³‡æ–™åº«ã€ä¸­æ‰¾åˆ°å°æ‡‰è¨˜éŒ„ï¼Œé»æ“Šåˆªé™¤æŒ‰éˆ•ã€‚</p>
                  </div>
                </div>
                <div class="help-section" style="padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                  <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 18px; font-weight: 600;"><i class="fas fa-phone" style="margin-right: 8px;"></i>è¯çµ¡æˆ‘å€‘</h4>
                  <p style="margin: 0 0 8px 0; color: #374151;">å¦‚æœ‰å•é¡Œï¼Œè«‹è¯ç¹«å®¢æœï¼š</p>
                  <ul style="margin: 0; padding-left: 20px; color: #374151; line-height: 1.8;">
                    <li>Email: aiagent168168@gmail.com</li>
                    <li>Discord: <a href="https://AIJobschool.short.gy/UUwpEG" target="_blank" style="color: #3b82f6; text-decoration: none;">åŠ å…¥ç¤¾ç¾¤</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- è¼‰å…¥å…±ç”¨ JavaScript æª”æ¡ˆ -->
    <script src="assets/js/config.js?v=20251120"></script>
    <script src="assets/js/auth.js?v=20251120"></script>
    <script src="assets/js/api.js?v=20251120"></script>
    <script src="assets/js/common.js?v=20251120"></script>
    <script src="assets/js/userDB.js?v=20251120"></script>
    
    <script>
      // API_BASE_URL å·²åœ¨ config.js ä¸­å®šç¾©ç‚ºå…¨å±€è®Šæ•¸
      // é€™è£¡ç›´æ¥ä½¿ç”¨ window.APP_CONFIGï¼Œé¿å…é‡è¤‡è²æ˜
      const API_URL = window.APP_CONFIG?.API_BASE || 'https://api.aijob.com.tw';
      let ipPlanningToken = localStorage.getItem('ipPlanningToken') || '';
      let ipPlanningUser = JSON.parse(localStorage.getItem('ipPlanningUser') || 'null');

      // æ‰‹æ©Ÿç‰ˆæŠ½å±œåˆ‡æ›
      function toggleMobileDrawer() {
        const drawer = document.getElementById('mobileDrawer');
        const overlay = document.getElementById('mobileDrawerOverlay');
        
        if (drawer && overlay) {
          const isOpen = drawer.classList.contains('open');
          
          if (isOpen) {
            closeMobileDrawer();
          } else {
            openMobileDrawer();
          }
        }
      }

      function openMobileDrawer() {
        const drawer = document.getElementById('mobileDrawer');
        const overlay = document.getElementById('mobileDrawerOverlay');
        
        if (drawer && overlay) {
          drawer.classList.add('open');
          overlay.style.display = 'block';
          document.body.style.overflow = 'hidden';
        }
      }

      function closeMobileDrawer() {
        const drawer = document.getElementById('mobileDrawer');
        const overlay = document.getElementById('mobileDrawerOverlay');
        
        if (drawer && overlay) {
          drawer.classList.remove('open');
          overlay.style.display = 'none';
          document.body.style.overflow = '';
        }
      }
      
      // ç™»å…¥/ç™»å‡ºå‡½æ•¸ï¼ˆå¾ common.js ä½¿ç”¨ï¼‰
      function goToLogin() {
        if (window.ReelMindCommon && window.ReelMindCommon.goToLogin) {
          window.ReelMindCommon.goToLogin();
        } else {
          window.location.href = 'index.html';
        }
      }
      
      function logout() {
        // æ¸…é™¤æ‰€æœ‰ç™»å…¥ç›¸é—œçš„ localStorage
        localStorage.removeItem('ipPlanningToken');
        localStorage.removeItem('ipPlanningRefreshToken');
        localStorage.removeItem('ipPlanningUser');
        localStorage.removeItem('ipPlanningTokenUpdated');
        localStorage.removeItem('subscriptionStatus');
        
        // æ¸…é™¤ CSRF Token ç·©å­˜
        if (window.Api && window.Api.clearCsrfToken) {
          window.Api.clearCsrfToken();
        }
        
        // ç›´æ¥è·³è½‰åˆ°é¦–é ï¼ˆä¸é¡¯ç¤ºä¸­é–“é é¢ï¼‰
        window.location.href = 'index.html';
      }
      
      // æ›´æ–°ç”¨æˆ¶è³‡è¨Šé¡¯ç¤º
      function updateUserInfo() {
        const userInfoDiv = document.getElementById('userInfo');
        const authButtonsDiv = document.getElementById('authButtons');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const dbUserAvatar = document.getElementById('dbUserAvatar');
        const dbUserName = document.getElementById('dbUserName');
        const dbUserEmail = document.getElementById('dbUserEmail');
        
        if (ipPlanningUser && ipPlanningToken) {
          // é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
          if (userInfoDiv) userInfoDiv.style.display = 'flex';
          if (authButtonsDiv) authButtonsDiv.style.display = 'none';
          
          if (userAvatar && ipPlanningUser.picture) {
            userAvatar.src = ipPlanningUser.picture;
            userAvatar.alt = ipPlanningUser.name || 'ç”¨æˆ¶é ­åƒ';
          }
          
          if (userName) {
            userName.textContent = ipPlanningUser.name || 'ç”¨æˆ¶';
          }
          
          if (dbUserAvatar && ipPlanningUser.picture) {
            dbUserAvatar.src = ipPlanningUser.picture;
            dbUserAvatar.alt = ipPlanningUser.name || 'ç”¨æˆ¶é ­åƒ';
          }
          
          if (dbUserName) {
            dbUserName.textContent = ipPlanningUser.name || 'ç”¨æˆ¶åç¨±';
          }
          
          if (dbUserEmail) {
            dbUserEmail.textContent = ipPlanningUser.email || 'user@example.com';
          }
        } else {
          // é¡¯ç¤ºç™»å…¥æŒ‰éˆ•
          if (userInfoDiv) userInfoDiv.style.display = 'none';
          if (authButtonsDiv) authButtonsDiv.style.display = 'flex';
        }
      }
      
      // åˆ‡æ›è³‡æ–™åº«å€å¡Š
      async function showDbSection(sectionName) {
        // éš±è—æ‰€æœ‰åˆ†å€
        document.querySelectorAll('.db-section').forEach(section => {
          section.classList.remove('active');
        });
        
        // ç§»é™¤æ‰€æœ‰é¸å–®é …çš„activeç‹€æ…‹
        document.querySelectorAll('.menu-item').forEach(item => {
          item.classList.remove('active');
        });
        
        // é¡¯ç¤ºé¸ä¸­çš„åˆ†å€
        const targetSection = document.getElementById(`db-${sectionName}`);
        if (targetSection) {
          targetSection.classList.add('active');
        }
        
        // æ·»åŠ å°æ‡‰é¸å–®é …çš„activeç‹€æ…‹
        const targetMenuItem = document.querySelector(`[onclick="showDbSection('${sectionName}')"]`);
        if (targetMenuItem) {
          targetMenuItem.classList.add('active');
        }
        
        // æ ¹æ“šåˆ†å€è¼‰å…¥ç›¸æ‡‰æ•¸æ“š
        try {
        switch(sectionName) {
          case 'personalInfo':
              // å„ªå…ˆä½¿ç”¨ userDB.js ä¸­çš„å‡½æ•¸
              if (window.loadPersonalInfoForUserDB && typeof window.loadPersonalInfoForUserDB === 'function') {
                await window.loadPersonalInfoForUserDB();
              } else if (typeof loadPersonalInfoForUserDB === 'function') {
                await loadPersonalInfoForUserDB();
              }
            break;
          case 'myScripts':
              if (window.loadMyScriptsForUserDB && typeof window.loadMyScriptsForUserDB === 'function') {
                await window.loadMyScriptsForUserDB();
              } else if (typeof loadMyScriptsForUserDB === 'function') {
                await loadMyScriptsForUserDB();
              }
            break;
          case 'settings':
              // ç¢ºä¿ loadSavedApiKey å‡½æ•¸å·²è¼‰å…¥
              if (typeof loadSavedApiKey === 'function') {
                await loadSavedApiKey();
              } else if (window.loadSavedApiKey && typeof window.loadSavedApiKey === 'function') {
                await window.loadSavedApiKey();
              } else {
                console.error('loadSavedApiKey å‡½æ•¸æœªæ‰¾åˆ°');
              }
            break;
          case 'accountPositioning':
              if (window.loadPositioningRecordsForUserDB && typeof window.loadPositioningRecordsForUserDB === 'function') {
                await window.loadPositioningRecordsForUserDB();
              } else if (typeof loadPositioningRecordsForUserDB === 'function') {
                await loadPositioningRecordsForUserDB();
              }
            break;
          case 'topicRecords':
              if (window.loadTopicHistoryForUserDB && typeof window.loadTopicHistoryForUserDB === 'function') {
                await window.loadTopicHistoryForUserDB();
              } else if (typeof loadTopicHistoryForUserDB === 'function') {
                await loadTopicHistoryForUserDB();
              }
            break;
          case 'ipPlanning':
              if (window.loadIpPlanningResultsForUserDB && typeof window.loadIpPlanningResultsForUserDB === 'function') {
                await window.loadIpPlanningResultsForUserDB();
              } else if (typeof loadIpPlanningResultsForUserDB === 'function') {
                await loadIpPlanningResultsForUserDB();
              }
            break;
          case 'myOrders':
              if (window.loadMyOrdersForUserDB && typeof window.loadMyOrdersForUserDB === 'function') {
                await window.loadMyOrdersForUserDB();
              } else if (typeof loadMyOrdersForUserDB === 'function') {
                await loadMyOrdersForUserDB();
              }
            break;
          case 'usageStats':
              if (window.loadUsageStatsForUserDB && typeof window.loadUsageStatsForUserDB === 'function') {
                await window.loadUsageStatsForUserDB();
              } else if (typeof loadUsageStatsForUserDB === 'function') {
                await loadUsageStatsForUserDB();
              }
            break;
          case 'helpCenter':
            // å¹«åŠ©ä¸­å¿ƒå…§å®¹å·²åœ¨HTMLä¸­å®šç¾©ï¼Œç„¡éœ€å‹•æ…‹è¼‰å…¥
            break;
        }
        } catch (error) {
          console.error('è¼‰å…¥åˆ†å€æ•¸æ“šå¤±æ•—:', error);
          if (window.ReelMindCommon && window.ReelMindCommon.showToast) {
            window.ReelMindCommon.showToast('è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦', 3000);
          }
        }
      }
      
      // å°å‡ºåˆ° window ä»¥ä¾¿ HTML onclick èª¿ç”¨
      window.showDbSection = showDbSection;
      
      // çµ±ä¸€çš„è¼‰å…¥å‹•ç•«å‡½æ•¸
      function showLoadingAnimation(container, message = 'è¼‰å…¥ä¸­...') {
        if (!container) return;
        container.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; padding: 40px; gap: 12px; flex-direction: column;">
            <div class="spinner" style="width: 24px; height: 24px; border: 3px solid #e5e7eb; border-top: 3px solid #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 8px;"></div>
            <span style="color: #6b7280; font-size: 14px;">${message}</span>
          </div>
        `;
      }
      
      // æ ¼å¼åŒ–å°ç£æ™‚å€æ™‚é–“
      function formatTaiwanTime(dateString) {
        if (!dateString) return '-';
        try {
          const date = new Date(dateString);
          if (isNaN(date.getTime())) {
            return dateString;
          }
          return date.toLocaleString('zh-TW', {
            timeZone: 'Asia/Taipei',
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit'
          });
        } catch (error) {
          console.error('æ ¼å¼åŒ–å°ç£æ™‚å€æ™‚é–“éŒ¯èª¤:', error);
          return dateString;
        }
      }
      
      // é¡¯ç¤º Toast é€šçŸ¥
      function showToast(message, duration = 3000) {
        if (window.ReelMindCommon && window.ReelMindCommon.showToast) {
          window.ReelMindCommon.showToast(message, duration);
        } else {
          alert(message);
        }
      }
      
      // è¼‰å…¥å€‹äººè³‡æ–™åº«çš„å€‹äººè³‡æ–™ï¼ˆæ­¤å‡½æ•¸å·²è¢« assets/js/userDB.js ä¸­çš„ç‰ˆæœ¬è¦†è“‹ï¼Œä¿ç•™æ­¤è™•åƒ…ä½œç‚ºå‚™ç”¨ï¼‰
      async function loadPersonalInfoForUserDB() {
        // å¦‚æœ userDB.js ä¸­çš„å‡½æ•¸å·²è¼‰å…¥ï¼Œä½¿ç”¨é‚£å€‹ç‰ˆæœ¬ï¼ˆé¿å…éè¿´èª¿ç”¨ï¼‰
        const userDBJsFunction = window.loadPersonalInfoForUserDB;
        if (userDBJsFunction && userDBJsFunction !== arguments.callee && typeof userDBJsFunction === 'function') {
          try {
            const funcString = userDBJsFunction.toString();
            if (funcString.includes('assets/js/userDB.js') || funcString.length > 500) {
              return await userDBJsFunction();
            }
          } catch (e) {
            console.warn('èª¿ç”¨ userDB.js ä¸­çš„ loadPersonalInfoForUserDB å¤±æ•—ï¼Œä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬:', e);
          }
        }
        
        const content = document.querySelector('#db-personalInfo .section-content');
        if (!content) return;
        
        if (!ipPlanningUser) {
          content.innerHTML = '<div class="loading-text">è«‹å…ˆç™»å…¥ä»¥æŸ¥çœ‹å€‹äººè³‡æ–™</div>';
          return;
        }
        
        // å¦‚æœç”¨æˆ¶è³‡æ–™å·²ç¶“å®Œæ•´ï¼Œç›´æ¥æ¸²æŸ“ï¼Œä¸éœ€è¦ loading å’Œå»¶é²
        if (ipPlanningUser && (ipPlanningUser.name || ipPlanningUser.email) && ipPlanningUser.created_at) {
          await renderPersonalInfoContent();
          return;
        }
        
        // åªæœ‰åœ¨éœ€è¦è¼‰å…¥è³‡æ–™æ™‚æ‰é¡¯ç¤º loading
        showLoadingAnimation(content, 'è¼‰å…¥å€‹äººè³‡æ–™ä¸­...');
        
        // å¦‚æœç”¨æˆ¶è³‡æ–™ä¸å®Œæ•´ï¼Œå…ˆå˜—è©¦å¾ API ç²å–
        if (ipPlanningToken && !ipPlanningUser.created_at) {
          try {
            await fetchUserInfo();
            // API è«‹æ±‚å®Œæˆå¾Œå†æ¸²æŸ“
            await renderPersonalInfoContent();
          } catch (error) {
            console.warn('ç„¡æ³•å¾ä¼ºæœå™¨ç²å–æœ€æ–°è³‡è¨Šï¼Œä½¿ç”¨æœ¬åœ°è³‡æ–™');
            // å³ä½¿ API å¤±æ•—ï¼Œä¹Ÿå˜—è©¦ç”¨æœ¬åœ°è³‡æ–™æ¸²æŸ“
            if (ipPlanningUser && (ipPlanningUser.name || ipPlanningUser.email)) {
              await renderPersonalInfoContent();
            } else {
              content.innerHTML = '<div class="loading-text">è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦</div>';
            }
          }
        } else if (ipPlanningUser && (ipPlanningUser.name || ipPlanningUser.email)) {
          // æœ‰æœ¬åœ°è³‡æ–™ä½†æ²’æœ‰ created_atï¼Œç›´æ¥æ¸²æŸ“ï¼ˆä¸éœ€è¦ç­‰å¾…ï¼‰
          await renderPersonalInfoContent();
        } else {
          content.innerHTML = '<div class="loading-text">æš«ç„¡å€‹äººè³‡æ–™</div>';
        }
      }
      
      // æ¸²æŸ“å€‹äººè³‡æ–™å…§å®¹
      async function renderPersonalInfoContent() {
        const content = document.querySelector('#db-personalInfo .section-content');
        if (!content || !ipPlanningUser) return;
        
        let registrationTime = 'æœªçŸ¥';
        if (ipPlanningUser.created_at) {
          try {
            const date = new Date(ipPlanningUser.created_at);
            if (!isNaN(date.getTime())) {
              registrationTime = date.toLocaleString('zh-TW', {
                timeZone: 'Asia/Taipei',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
              });
            }
          } catch (e) {
            registrationTime = ipPlanningUser.created_at;
          }
        }
        
        const isSubscribed = ipPlanningUser.is_subscribed !== false;
        const subscriptionStatus = isSubscribed ? 
          '<span style="color: #10b981; font-weight: bold;"><i class="fas fa-check-circle" style="margin-right: 4px;"></i>å·²è¨‚é–±</span>' : 
          '<span style="color: #ef4444; font-weight: bold;"><i class="fas fa-times-circle" style="margin-right: 4px;"></i>æœªè¨‚é–±</span>';
        
        let expiresAt = null;
        let daysLeft = null;
        let expiresAtText = 'æœªçŸ¥';
        let daysLeftText = '';
        let expirationWarning = '';
        
        if (ipPlanningToken && ipPlanningUser?.user_id) {
          try {
            const subResponse = await fetch(`${API_URL}/api/user/subscription`, {
              headers: {
                'Authorization': `Bearer ${ipPlanningToken}`
              }
            });
            
            if (subResponse.ok) {
              const subData = await subResponse.json();
              if (subData.expires_at) {
                expiresAt = new Date(subData.expires_at);
                const now = new Date();
                daysLeft = Math.ceil((expiresAt - now) / (1000 * 60 * 60 * 24));
                
                expiresAtText = expiresAt.toLocaleString('zh-TW', {
                  timeZone: 'Asia/Taipei',
                  year: 'numeric',
                  month: '2-digit',
                  day: '2-digit',
                  hour: '2-digit',
                  minute: '2-digit'
                });
                
                if (daysLeft < 0) {
                  daysLeftText = `<span style="color: #ef4444; font-weight: bold;">ï¼ˆå·²éæœŸ ${Math.abs(daysLeft)} å¤©ï¼‰</span>`;
                  expirationWarning = '<div style="margin-top: 12px; padding: 12px; background: #fee2e2; border: 1px solid #fca5a5; border-radius: 8px; color: #991b1b;"><strong><i class="fas fa-exclamation-triangle" style="margin-right: 4px;"></i>è¨‚é–±å·²éæœŸ</strong><br>è«‹å‰å¾€è¨‚é–±é é¢çºŒè²»ä»¥ç¹¼çºŒä½¿ç”¨æœå‹™ã€‚</div>';
                } else if (daysLeft <= 3) {
                  daysLeftText = `<span style="color: #ef4444; font-weight: bold;">ï¼ˆå‰©é¤˜ ${daysLeft} å¤©ï¼‰</span>`;
                  expirationWarning = '<div style="margin-top: 12px; padding: 12px; background: #fef3c7; border: 1px solid #fde68a; border-radius: 8px; color: #92400e;"><strong><i class="fas fa-exclamation-triangle" style="margin-right: 4px;"></i>è¨‚é–±å³å°‡åˆ°æœŸ</strong><br>è«‹ç›¡å¿«å‰å¾€è¨‚é–±é é¢çºŒè²»ã€‚</div>';
                } else if (daysLeft <= 7) {
                  daysLeftText = `<span style="color: #f59e0b; font-weight: bold;">ï¼ˆå‰©é¤˜ ${daysLeft} å¤©ï¼‰</span>`;
                  expirationWarning = '<div style="margin-top: 12px; padding: 12px; background: #fffbeb; border: 1px solid #fde68a; border-radius: 8px; color: #92400e;"><strong>æé†’</strong><br>æ‚¨çš„è¨‚é–±å°‡åœ¨ 7 å¤©å…§åˆ°æœŸï¼Œè«‹è¨˜å¾—çºŒè²»ã€‚</div>';
                } else {
                  daysLeftText = `<span style="color: #10b981;">ï¼ˆå‰©é¤˜ ${daysLeft} å¤©ï¼‰</span>`;
                }
              }
            }
          } catch (e) {
            console.warn('è¼‰å…¥è¨‚é–±è©³æƒ…å¤±æ•—:', e);
          }
        }
        
        content.innerHTML = `
          <div class="profile-details">
            <div class="detail-item">
              <label>å§“åï¼š</label>
              <span>${escapeHtml(ipPlanningUser.name || 'æœªè¨­å®š')}</span>
            </div>
            <div class="detail-item">
              <label>Emailï¼š</label>
              <span>${escapeHtml(ipPlanningUser.email || 'æœªè¨­å®š')}</span>
            </div>
            <div class="detail-item">
              <label>ç”¨æˆ¶IDï¼š</label>
              <span>${escapeHtml(ipPlanningUser.user_id || 'æœªç”Ÿæˆ')}</span>
            </div>
            <div class="detail-item">
              <label>è¨»å†Šæ™‚é–“ï¼š</label>
              <span>${escapeHtml(registrationTime)}</span>
            </div>
            <div class="detail-item">
              <label>è¨‚é–±ç‹€æ…‹ï¼š</label>
              <span>${subscriptionStatus}</span>
            </div>
            ${isSubscribed ? `
            <div class="detail-item">
              <label>åˆ°æœŸæ—¥æœŸï¼š</label>
              <span>${escapeHtml(expiresAtText)} ${daysLeftText}</span>
            </div>
            ${expirationWarning}
            <div class="detail-actions" style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
              <a href="subscription.html" style="display: inline-flex; align-items: center; justify-content: center; padding: 10px 16px; min-height: 44px; background: #3B82F6; color: white; border-radius: 6px; text-decoration: none; font-weight: 500; font-size: 14px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                <i class="fas fa-credit-card" style="margin-right: 4px;"></i>çºŒè²»è¨‚é–±
              </a>
              ${userInfo.auto_renew !== false ? `
              <button onclick="cancelAutoRenewForUserDB()" style="display: inline-block; padding: 10px 16px; min-height: 44px; background: #EF4444; color: white; border: none; border-radius: 6px; font-weight: 500; cursor: pointer; font-size: 14px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                <i class="fas fa-ban" style="margin-right: 4px;"></i>å–æ¶ˆè‡ªå‹•çºŒè²»
              </button>
              ` : `
              <div style="display: inline-block; padding: 8px 16px; background: #F3F4F6; color: #6B7280; border-radius: 6px; font-weight: 500; font-size: 14px;">
                <i class="fas fa-check-circle" style="margin-right: 4px;"></i>å·²å–æ¶ˆè‡ªå‹•çºŒè²»
              </div>
              `}
            </div>
            ` : `
            <div class="detail-actions">
              <a href="subscription.html" style="display: inline-block; padding: 10px 16px; min-height: 44px; background: #10b981; color: white; border-radius: 6px; text-decoration: none; font-weight: 500; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                âœ¨ å•Ÿç”¨è¨‚é–±
              </a>
            </div>
            `}
          </div>
        `;
      }
      
      // XSS é˜²è­·å‡½æ•¸
      function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
      
      // ç²å–ç”¨æˆ¶è³‡è¨Š
      async function fetchUserInfo() {
        if (!ipPlanningToken) return;
        
        try {
          const response = await fetch(`${API_URL}/api/auth/me`, {
            headers: {
              'Authorization': `Bearer ${ipPlanningToken}`
            }
          });
          
          if (response.ok) {
            const userData = await response.json();
            ipPlanningUser = userData;
            localStorage.setItem('ipPlanningUser', JSON.stringify(userData));
            updateUserInfo();
            
            // ç²å–ç”¨æˆ¶è³‡è¨Šå¾Œï¼Œæª¢æŸ¥ IP äººè¨­è¦åŠƒæ¬Šé™
            if (typeof checkIpPlanningPermission === 'function') {
              await checkIpPlanningPermission();
            }
          } else if (response.status === 401) {
            // Token éæœŸï¼Œå˜—è©¦åˆ·æ–°
            if (window.Api && window.Api.refreshTokenIfNeeded) {
              await window.Api.refreshTokenIfNeeded();
              // åˆ·æ–°å¾Œé‡è©¦
              if (ipPlanningToken) {
                return fetchUserInfo();
              }
            }
          }
        } catch (error) {
          console.error('ç²å–ç”¨æˆ¶è³‡è¨Šå¤±æ•—:', error);
        }
      }
      
      // è™•ç†é¸å–®é»æ“Šï¼ˆæ‰‹æ©Ÿç‰ˆç”¨å½ˆè·³è¦–çª—ï¼Œæ¡Œé¢ç‰ˆç”¨åŸæœ‰æ–¹å¼ï¼‰
      function handleMenuClick(sectionName) {
        const isMobile = window.innerWidth <= 768;
        
        if (isMobile) {
          // æ‰‹æ©Ÿç‰ˆï¼šé¡¯ç¤ºå½ˆè·³è¦–çª—
          openUserDbModal(sectionName);
        } else {
          // æ¡Œé¢ç‰ˆï¼šä½¿ç”¨åŸæœ‰æ–¹å¼
          showDbSection(sectionName);
        }
      }
      
      // æª¢æŸ¥ IP äººè¨­è¦åŠƒæ¬Šé™ï¼ˆé é¢è¼‰å…¥æ™‚ï¼‰
      if (typeof checkIpPlanningPermission === 'function') {
        checkIpPlanningPermission();
      }
      
      // æ‰“é–‹å½ˆè·³è¦–çª—
      function openUserDbModal(sectionName) {
        const overlay = document.getElementById('userdbModalOverlay');
        const titleEl = document.getElementById('userdbModalTitle');
        const bodyEl = document.getElementById('userdbModalBody');
        
        if (!overlay || !titleEl || !bodyEl) {
          console.error('å½ˆè·³è¦–çª—å…ƒç´ æœªæ‰¾åˆ°:', { overlay, titleEl, bodyEl });
          return;
        }
        
        console.log('æ‰“é–‹å½ˆè·³è¦–çª—:', sectionName);
        
        // è¨­ç½®æ¨™é¡Œ
        const titleMap = {
          'personalInfo': 'å€‹äººè³‡æ–™',
          'myScripts': 'æˆ‘çš„è…³æœ¬',
          'accountPositioning': 'å¸³è™Ÿå®šä½',
          'topicRecords': 'é¸é¡Œå…§å®¹',
          'ipPlanning': 'IPäººè¨­è¦åŠƒ',
          'myOrders': 'æˆ‘çš„è¨‚å–®',
          'settings': 'è¨­å®š',
          'usageStats': 'ä½¿ç”¨çµ±è¨ˆ',
          'helpCenter': 'å¹«åŠ©ä¸­å¿ƒ'
        };
        titleEl.textContent = titleMap[sectionName] || 'å…§å®¹';
        
        // æ›´æ–°é¸å–®é …çš„ active ç‹€æ…‹
        document.querySelectorAll('.menu-item').forEach(item => {
          item.classList.remove('active');
        });
        const targetMenuItem = document.querySelector(`[onclick="handleMenuClick('${sectionName}')"]`);
        if (targetMenuItem) {
          targetMenuItem.classList.add('active');
        }
        
        // è¼‰å…¥å…§å®¹
        bodyEl.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; padding: 40px;"><div class="spinner" style="width: 24px; height: 24px; border: 3px solid #e5e7eb; border-top: 3px solid #3b82f6; border-radius: 50%; animation: spin 1s linear infinite;"></div></div>';
        
        // ç²å–å°æ‡‰çš„å…§å®¹å€åŸŸ
        const targetSection = document.getElementById(`db-${sectionName}`);
        if (!targetSection) {
          console.error('æ‰¾ä¸åˆ°ç›®æ¨™å€å¡Š:', `db-${sectionName}`);
          bodyEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #ef4444;">æ‰¾ä¸åˆ°å°æ‡‰çš„å…§å®¹å€å¡Š</div>';
          return;
        }
        
        // å…ˆé¡¯ç¤ºå…§å®¹å€åŸŸï¼ˆè‡¨æ™‚ï¼‰ä»¥ç²å–å…§å®¹
        const originalDisplay = targetSection.style.display;
        targetSection.style.display = 'block';
        const sectionContent = targetSection.querySelector('.section-content');
        
        if (!sectionContent) {
          console.error('æ‰¾ä¸åˆ° section-content:', targetSection);
          bodyEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #ef4444;">æ‰¾ä¸åˆ°å…§å®¹å€åŸŸ</div>';
          targetSection.style.display = originalDisplay;
          return;
        }
        
        // è¼‰å…¥æ•¸æ“šï¼ˆå„ªåŒ–ç‰ˆï¼šå€‹äººè³‡æ–™å„ªå…ˆä½¿ç”¨å·²è¼‰å…¥çš„è³‡æ–™ï¼‰
        const loadContent = async () => {
          try {
            // å€‹äººè³‡æ–™ç‰¹æ®Šè™•ç†ï¼šå¦‚æœè³‡æ–™å·²å®Œæ•´ï¼Œç›´æ¥æ¸²æŸ“ï¼Œä¸éœ€è¦ç­‰å¾… API
            if (sectionName === 'personalInfo' && ipPlanningUser && (ipPlanningUser.name || ipPlanningUser.email)) {
              // è³‡æ–™å·²å­˜åœ¨ï¼Œå…ˆå˜—è©¦ç›´æ¥æ¸²æŸ“ï¼ˆä½¿ç”¨ userDB.html ä¸­çš„ renderPersonalInfoContentï¼‰
              if (typeof renderPersonalInfoContent === 'function') {
                // ç¢ºä¿ section å¯è¦‹ä»¥æ¸²æŸ“å…§å®¹
                targetSection.style.display = 'block';
                await renderPersonalInfoContent();
                // ç­‰å¾…æ¸²æŸ“å®Œæˆï¼ˆæ¸›å°‘å»¶é²ï¼‰
                await new Promise(resolve => setTimeout(resolve, 50));
                if (sectionContent && sectionContent.innerHTML && sectionContent.innerHTML.trim() !== '') {
                  bodyEl.innerHTML = sectionContent.innerHTML;
                  console.log('å€‹äººè³‡æ–™å·²å¿«é€Ÿè¼‰å…¥åˆ°å½ˆè·³è¦–çª—');
                  targetSection.style.display = originalDisplay || 'none';
                  return;
                }
              }
            }
            
            switch(sectionName) {
              case 'personalInfo':
                await loadPersonalInfoForUserDB();
                break;
              case 'myScripts':
                await loadMyScriptsForUserDB();
                break;
              case 'settings':
                loadSavedApiKey();
                // ç­‰å¾…ä¸€ä¸‹è®“å…§å®¹æ¸²æŸ“
                await new Promise(resolve => setTimeout(resolve, 100));
                break;
              case 'accountPositioning':
                await loadPositioningRecordsForUserDB();
                break;
              case 'topicRecords':
                await loadTopicHistoryForUserDB();
                break;
              case 'ipPlanning':
                await loadIpPlanningResultsForUserDB();
                break;
              case 'myOrders':
                await loadMyOrdersForUserDB();
                break;
              case 'usageStats':
                await loadUsageStatsForUserDB();
                break;
              case 'helpCenter':
                // å¹«åŠ©ä¸­å¿ƒå…§å®¹å·²åœ¨HTMLä¸­å®šç¾©ï¼Œç„¡éœ€å‹•æ…‹è¼‰å…¥
                break;
            }
            
            // ç­‰å¾…å…§å®¹æ¸²æŸ“å¾Œå†è¤‡è£½ï¼ˆå€‹äººè³‡æ–™å·²å„ªåŒ–ï¼Œæ¸›å°‘å»¶é²ï¼‰
            const delay = sectionName === 'personalInfo' ? 10 : 300;
            await new Promise(resolve => setTimeout(resolve, delay));
            
            // å¦‚æœå…§å®¹é‚„æ˜¯ç©ºçš„ï¼Œå†ç­‰å¾…ä¸€ä¸‹
            if (!sectionContent || !sectionContent.innerHTML || sectionContent.innerHTML.trim() === '') {
              await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            if (sectionContent && sectionContent.innerHTML && sectionContent.innerHTML.trim() !== '') {
              bodyEl.innerHTML = sectionContent.innerHTML;
              console.log('å…§å®¹å·²è¼‰å…¥åˆ°å½ˆè·³è¦–çª—');
            } else {
              // å¦‚æœé‚„æ˜¯æ²’æœ‰å…§å®¹ï¼Œé¡¯ç¤ºè¼‰å…¥ä¸­æˆ–æš«ç„¡å…§å®¹
              if (sectionName === 'personalInfo') {
                bodyEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #6b7280;">è¼‰å…¥ä¸­...</div>';
                // å†ç­‰å¾…ä¸€ä¸‹ï¼Œå¦‚æœé‚„æ˜¯æ²’æœ‰ï¼Œé¡¯ç¤ºæš«ç„¡å…§å®¹
                setTimeout(() => {
                  if (!sectionContent || !sectionContent.innerHTML || sectionContent.innerHTML.trim() === '') {
                    bodyEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #6b7280;">æš«ç„¡å…§å®¹</div>';
                  } else {
                    bodyEl.innerHTML = sectionContent.innerHTML;
                  }
                }, 500);
              } else {
                bodyEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #6b7280;">æš«ç„¡å…§å®¹</div>';
              }
            }
          } catch (error) {
            console.error('è¼‰å…¥å…§å®¹å¤±æ•—:', error);
            bodyEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #ef4444;">è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦</div>';
          } finally {
            targetSection.style.display = originalDisplay || 'none';
          }
        };
        
        // å…ˆé¡¯ç¤ºå½ˆè·³è¦–çª—ï¼Œå†è¼‰å…¥å…§å®¹
        overlay.classList.add('show');
        overlay.style.cssText = 'display: flex !important; visibility: visible !important; opacity: 1 !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; height: 100dvh !important; z-index: 99999 !important; background: rgba(0, 0, 0, 0.5) !important; justify-content: center !important; align-items: center !important; padding: 20px !important; box-sizing: border-box !important; margin: 0 !important;';
        document.body.style.overflow = 'hidden';
        document.body.style.position = 'fixed';
        document.body.style.width = '100%';
        document.documentElement.style.overflow = 'hidden'; // é˜²æ­¢ iOS Safari æ»¾å‹•
        
        console.log('å½ˆè·³è¦–çª—å·²é¡¯ç¤ºï¼Œoverlay classes:', overlay.className);
        console.log('å½ˆè·³è¦–çª— computed style:', window.getComputedStyle(overlay).display);
        console.log('å½ˆè·³è¦–çª— visibility:', window.getComputedStyle(overlay).visibility);
        console.log('å½ˆè·³è¦–çª— opacity:', window.getComputedStyle(overlay).opacity);
        
        // è¼‰å…¥å…§å®¹
        loadContent();
        
        // é»æ“ŠèƒŒæ™¯é—œé–‰
        overlay.onclick = function(e) {
          if (e.target === overlay) {
            closeUserDbModal();
          }
        };
        
        // ESC éµé—œé–‰
        const handleEsc = (e) => {
          if (e.key === 'Escape') {
            closeUserDbModal();
            document.removeEventListener('keydown', handleEsc);
          }
        };
        document.addEventListener('keydown', handleEsc);
      }
      
      // é—œé–‰å½ˆè·³è¦–çª—
      function closeUserDbModal() {
        const overlay = document.getElementById('userdbModalOverlay');
        if (overlay) {
          overlay.classList.remove('show');
          overlay.style.cssText = 'display: none !important; visibility: hidden !important; opacity: 0 !important;';
          document.body.style.overflow = '';
          document.body.style.position = '';
          document.body.style.width = '';
          document.documentElement.style.overflow = '';
          console.log('å½ˆè·³è¦–çª—å·²é—œé–‰');
        }
      }
      
      // å°‡å‡½æ•¸å°å‡ºåˆ°å…¨å±€ï¼Œæ–¹ä¾¿èª¿è©¦å’Œ HTML onclick èª¿ç”¨
      window.handleMenuClick = handleMenuClick;
      window.openUserDbModal = openUserDbModal;
      window.closeUserDbModal = closeUserDbModal;
      
      // åˆå§‹åŒ–é é¢
      document.addEventListener('DOMContentLoaded', async () => {
        // æª¢æŸ¥ç™»å…¥ç‹€æ…‹ï¼ˆå‰µä½œè€…è³‡æ–™åº«å…è¨±æœªè¨‚é–±ç”¨æˆ¶è¨ªå•ï¼Œè‡³å°‘å¯æŸ¥çœ‹å€‹äººè³‡è¨Šå’Œç™»å‡ºï¼‰
        if (window.ReelMindCommon && window.ReelMindCommon.checkFeatureAccess) {
          const canAccess = await window.ReelMindCommon.checkFeatureAccess('userDB');
          if (!canAccess) {
            return; // checkFeatureAccess å·²ç¶“è™•ç†äº†è·³è½‰ï¼ˆæœªç™»å…¥æœƒå°å‘ç™»å…¥ï¼‰
          }
        }
        
        // è¼‰å…¥ç”¨æˆ¶è³‡è¨Š
        if (window.Auth && window.Auth.getToken()) {
          ipPlanningToken = window.Auth.getToken();
        }
        
        if (window.ReelMindCommon && window.ReelMindCommon.getUser) {
          ipPlanningUser = window.ReelMindCommon.getUser();
        } else {
          const userStr = localStorage.getItem('ipPlanningUser');
          ipPlanningUser = userStr ? JSON.parse(userStr) : null;
        }
        
        // æ›´æ–°ç”¨æˆ¶è³‡è¨Šé¡¯ç¤º
        updateUserInfo();
        
        // ç­‰å¾…ç”¨æˆ¶è³‡æ–™è¼‰å…¥å®Œæˆå¾Œå†æ‰“é–‹å½ˆè·³è¦–çª—ï¼ˆé¿å…å»¶é²ï¼‰
        const initializeUserDB = async () => {
          // å¦‚æœæ²’æœ‰ç”¨æˆ¶è³‡è¨Šä½†æœ‰ tokenï¼Œå…ˆç²å–ç”¨æˆ¶è³‡è¨Š
        if (ipPlanningToken && (!ipPlanningUser || !ipPlanningUser.user_id)) {
            try {
          await fetchUserInfo();
            } catch (error) {
              console.warn('ç²å–ç”¨æˆ¶è³‡è¨Šå¤±æ•—:', error);
            }
          }
          
          // æª¢æŸ¥ URL hashï¼Œå¦‚æœæœ‰æŒ‡å®šåˆ†é¡å‰‡è·³è½‰åˆ°è©²åˆ†é¡
          const hash = window.location.hash.replace('#', '');
          const isMobile = window.innerWidth <= 768;
          
          if (hash) {
            // æœ‰ hashï¼Œè·³è½‰åˆ°æŒ‡å®šåˆ†é¡
            if (isMobile) {
              // æ‰‹æ©Ÿç‰ˆï¼šæ‰“é–‹å°æ‡‰çš„å½ˆè·³è¦–çª—ï¼ˆæ¸›å°‘å»¶é²ï¼‰
              setTimeout(() => {
                openUserDbModal(hash);
              }, 100);
            } else {
              // æ¡Œé¢ç‰ˆï¼šåˆ‡æ›åˆ°å°æ‡‰çš„åˆ†é¡
              if (typeof showDbSection === 'function') {
                showDbSection(hash);
              }
            }
          } else {
            // æ²’æœ‰ hashï¼Œè¼‰å…¥å€‹äººè³‡æ–™ï¼ˆé è¨­é¡¯ç¤ºï¼‰
            if (isMobile) {
              // æ‰‹æ©Ÿç‰ˆï¼šé è¨­æ‰“é–‹å€‹äººè³‡æ–™å½ˆè·³è¦–çª—ï¼ˆæ¸›å°‘å»¶é²ï¼‰
              setTimeout(() => {
                openUserDbModal('personalInfo');
              }, 100);
            } else {
              // æ¡Œé¢ç‰ˆï¼šä½¿ç”¨åŸæœ‰æ–¹å¼
              loadPersonalInfoForUserDB();
            }
          }
        };
        
        // åŸ·è¡Œåˆå§‹åŒ–
        await initializeUserDB();
        
        // ç›£è½ hash è®ŠåŒ–
        window.addEventListener('hashchange', function() {
          const newHash = window.location.hash.replace('#', '');
          if (newHash) {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
              openUserDbModal(newHash);
            } else {
              if (typeof showDbSection === 'function') {
                showDbSection(newHash);
              }
            }
          }
        });
        
        // ç”¨æˆ¶è³‡è¨Šç²å–å·²åœ¨ initializeUserDB ä¸­è™•ç†
      });
    </script>
    
    <!-- æ‰€æœ‰ userDB ç›¸é—œå‡½æ•¸å·²ç§»è‡³ assets/js/userDB.js -->
  </body>
</html>

