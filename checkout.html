<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>å¡«å¯«ä»˜æ¬¾è³‡è¨Šï½œReelMind</title>
<meta name="description" content="å¡«å¯«ä»˜æ¬¾è³‡è¨Šï¼Œå®Œæˆ ReelMind è¨‚é–±">
<meta name="theme-color" content="#2563EB" />
<!-- Favicon: ä½¿ç”¨ SVG data URIï¼Œé¿å… 404 éŒ¯èª¤ -->
<!-- Favicon: ReelMind Logo -->
<link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon-16x16.png" />
<link rel="apple-touch-icon" sizes="180x180" href="assets/images/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="192x192" href="assets/images/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="assets/images/android-chrome-512x512.png" />
<link rel="shortcut icon" href="assets/images/favicon.ico" />
<!-- HTTP å¿«å–æ¨™é ­ -->
<meta http-equiv="Cache-Control" content="public, max-age=3600">
<meta http-equiv="Expires" content="3600">
<style>
:root{
  --bg:#F8FAFC; --ink:#0F172A; --sub:#475569; --line:#E2E8F0; --card:#FFFFFF;
  --blue:#2563EB; --blue-deep:#1D4ED8; --ok:#16A34A; --warn:#F59E0B; --red:#DC2626;
  --shadow:0 16px 40px rgba(2,6,23,.08); --r:16px;
}
*{box-sizing:border-box} html,body{margin:0;color:var(--ink);-webkit-font-smoothing:antialiased}
body{
  font-family:ui-sans-serif,system-ui,-apple-system,"Noto Sans TC","PingFang TC",Segoe UI,Roboto,Arial;
  position: relative;
  min-height: 100vh;
  overflow-x: hidden;
}
/* è—ç™½æ¼¸å±¤æµå‹•èƒŒæ™¯ */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, #2563EB 0%, #1D4ED8 15%, #3B82F6 30%, #60A5FA 45%, #DBEAFE 60%, #F8FAFC 75%, #FFFFFF 100%);
  background-size: 400% 400%;
  animation: gradientFlow 10s ease infinite;
  z-index: -2;
}
/* æµå‹•æ³¢ç´‹æ•ˆæœ */
body::after {
  content: '';
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
  animation: rotateWave 25s linear infinite;
  pointer-events: none;
  z-index: -1;
}
@keyframes gradientFlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
@keyframes rotateWave {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
a{text-decoration:none;color:inherit}
.wrap{width:100%; position: relative; z-index: 1} 
.safe{max-width:1120px;margin:0 auto;padding:0 16px}
.hero{
  padding:40px 0 24px;
  background: transparent;
  border-bottom:1px solid var(--line);
  position: relative;
  z-index: 1;
}
.h1{font-size:28px;line-height:1.2;margin:0 0 6px}
.lead{color:var(--sub);margin:0;font-size:16px}
.badge{display:inline-flex;gap:8px;align-items:center;background:#E0F2FE;color:#075985;padding:8px 12px;border-radius:999px;font-weight:800;font-size:12px;margin-bottom:10px}
.grid{display:grid;gap:16px}
@media(min-width:980px){.cols-2{grid-template-columns:1.1fr 1fr}}
.card{
  background:rgba(255,255,255,0.95);
  backdrop-filter:blur(10px);
  border-radius:var(--r);
  box-shadow:0 20px 60px rgba(37,99,235,0.1);
  border:1px solid rgba(226,232,240,0.5);
}
.card .body{padding:24px}
.h2{font-size:22px;font-weight:900;margin:0 0 8px}
.h3{font-size:18px;font-weight:900;margin:0 0 6px}
.hr{height:1px;background:linear-gradient(90deg,transparent,var(--line),transparent);margin:12px 0}
.sub{color:var(--sub)}
.list{padding-left:18px;margin:8px 0} .list li{margin:6px 0;color:var(--sub)}
.row{display:flex;gap:10px;flex-wrap:wrap}
.input{width:100%;height:44px;border:1px solid #CBD5E1;border-radius:10px;padding:10px 12px;font-size:14px}
.select{width:100%;height:44px;border:1px solid #CBD5E1;border-radius:10px;padding:10px 12px;background:#fff}
.textarea{width:100%;min-height:88px;border:1px solid #CBD5E1;border-radius:12px;padding:12px}
.btn{display:inline-flex;align-items:center;justify-content:center;height:48px;padding:0 18px;border-radius:999px;font-weight:900;cursor:pointer;border:none}
.btn.blue{background:var(--blue);color:#fff}.btn.blue:hover{background:var(--blue-deep)}
.btn.ghost{border:1px solid #CBD5E1;background:#fff;color:#334155}
.payrow{display:grid;gap:10px}
.paybtn{width:100%;height:48px;border:1px solid #CBD5E1;border-radius:12px;background:#fff;display:flex;align-items:center;justify-content:center;font-weight:800;gap:8px;cursor:pointer}
.sum{background:#0B1220;color:#E5E7EB;border-radius:14px;padding:16px}
.sum .line{display:flex;justify-content:space-between;margin:8px 0}
.ft{padding:24px 0;color:#64748B;text-align:center;border-top:1px solid var(--line);font-size:14px}
.small{font-size:12px;color:#64748B}
.plan-summary{background:#F1F5F9;border-radius:12px;padding:16px;margin-bottom:16px}
.plan-summary .plan-name{font-size:18px;font-weight:900;margin-bottom:8px}
.plan-summary .plan-price{font-size:24px;font-weight:900;color:var(--blue)}
.plan-summary .plan-desc{color:var(--sub);font-size:14px;margin-top:4px}

/* å‹•ç•«æ•ˆæœ - èˆ‡ popup-callback.html é¢¨æ ¼ä¸€è‡´ */
@keyframes containerFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
}

@keyframes titleAnimation {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  60% {
    transform: translateY(-3px) scale(1.02);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Hero å€å¡Šå‹•ç•« */
.hero {
  opacity: 0;
  animation: fadeInUp 0.8s ease-out 0.2s forwards;
}

.hero .badge {
  opacity: 0;
  animation: fadeIn 0.6s ease-out 0.4s forwards;
}

.hero .h1 {
  opacity: 0;
  animation: titleAnimation 0.8s ease-out 0.5s forwards;
}

.hero .lead {
  opacity: 0;
  animation: fadeInUp 0.8s ease-out 0.6s forwards;
}

/* å¡ç‰‡å‹•ç•« - ç²¾ç·»çš„æ·¡å…¥æ•ˆæœ */
.card {
  opacity: 0;
  transform: scale(0.95) translateY(20px);
  animation: containerFadeIn 0.8s ease-out both;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
}

.card:hover {
  transform: translateY(-4px) scale(1.01);
  box-shadow: 0 20px 60px rgba(37, 99, 235, 0.15);
}

/* å·¦å³å¡ç‰‡åˆ†åˆ¥å‹•ç•« */
.card:nth-child(1) {
  animation: slideInLeft 0.8s ease-out 0.3s both;
}

.card:nth-child(2) {
  animation: slideInRight 0.8s ease-out 0.5s both;
}

/* æ–¹æ¡ˆæ‘˜è¦å‹•ç•« */
.plan-summary {
  opacity: 0;
  transform: translateY(20px) scale(0.95);
  animation: containerFadeIn 0.6s ease-out 0.7s both;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  background: rgba(241, 245, 249, 0.9);
  backdrop-filter: blur(5px);
}

.plan-summary:hover {
  transform: scale(1.02) translateY(-2px);
  box-shadow: 0 8px 25px rgba(37, 99, 235, 0.1);
}

/* è¼¸å…¥æ¡†å‹•ç•« */
.input, .select, .textarea {
  transition: all 0.3s ease;
  opacity: 0;
  transform: translateY(15px);
  animation: fadeInUp 0.5s ease-out both;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(5px);
}

.input:nth-of-type(1) { animation-delay: 0.8s; }
.input:nth-of-type(2) { animation-delay: 0.9s; }
.input:nth-of-type(3) { animation-delay: 1s; }
.select { animation-delay: 1.1s; }
.textarea { animation-delay: 1.2s; }

.input:focus, .select:focus, .textarea:focus {
  transform: scale(1.02) translateY(-2px);
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(37,99,235,.15), 0 4px 12px rgba(37,99,235,.1);
  background: rgba(255, 255, 255, 1);
}

/* æŒ‰éˆ•å‹•ç•« - ç²¾ç·»æ•ˆæœ */
.btn {
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  opacity: 0;
  transform: translateY(20px) scale(0.95);
  animation: containerFadeIn 0.6s ease-out 1.3s both;
}

.btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.4);
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
  z-index: 0;
}

.btn > * {
  position: relative;
  z-index: 1;
}

.btn:hover::before {
  width: 300px;
  height: 300px;
}

.btn:hover {
  transform: translateY(-3px) scale(1.02);
  box-shadow: 0 10px 30px rgba(37,99,235,.4);
}

.btn:active {
  transform: translateY(-1px) scale(1);
}

/* è¨‚å–®æ‘˜è¦å‹•ç•« */
.sum {
  opacity: 0;
  transform: translateY(20px) scale(0.95);
  animation: containerFadeIn 0.6s ease-out 1s both;
  background: rgba(11, 18, 32, 0.95);
  backdrop-filter: blur(10px);
}

.sum .line {
  opacity: 0;
  animation: fadeIn 0.4s ease-out both;
}

.sum .line:nth-child(1) { animation-delay: 1.2s; }
.sum .line:nth-child(2) { animation-delay: 1.3s; }
.sum .line:nth-child(3) { animation-delay: 1.4s; }

/* åˆ—è¡¨é …ç›®å‹•ç•« */
.list li {
  opacity: 0;
  transform: translateX(-10px);
  animation: fadeInUp 0.5s ease-out both;
}

.list li:nth-child(1) { animation-delay: 1.2s; }
.list li:nth-child(2) { animation-delay: 1.3s; }
.list li:nth-child(3) { animation-delay: 1.4s; }
.list li:nth-child(4) { animation-delay: 1.5s; }
.list li:nth-child(5) { animation-delay: 1.6s; }

/* Footer å‹•ç•« */
.ft {
  opacity: 0;
  animation: fadeIn 0.6s ease-out 1.7s both;
}

/* éŸ¿æ‡‰å¼ï¼šæ‰‹æ©Ÿç‰ˆæ¸›å°‘å‹•ç•«å»¶é² */
@media (max-width: 768px) {
  .card {
    animation-delay: 0s !important;
  }
  
  .input, .select, .textarea {
    animation-delay: 0s !important;
  }
  
  .list li {
    animation-delay: 0s !important;
  }
}

/* è¼‰å…¥å‹•ç•« */
@keyframes loading {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.btn:disabled::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top-color: white;
  border-radius: 50%;
  animation: loading 0.8s linear infinite;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
</style>
</head>
<body>

<!-- HERO -->
<header class="hero wrap">
  <div class="safe">
    <span class="badge">ä¸€æ¬¡ä»˜æ¬¾ Â· è‡ªå‹•çºŒç´„ Â· å¯éš¨æ™‚å–æ¶ˆ</span>
    <h1 class="h1">å¡«å¯«ä»˜æ¬¾è³‡è¨Š</h1>
    <p class="lead">å®Œæˆä»¥ä¸‹è³‡è¨Šå³å¯é–‹å§‹ä½¿ç”¨ ReelMind</p>
  </div>
</header>

<main class="wrap" style="padding:28px 0">
  <div class="safe grid cols-2">

    <!-- å·¦ï¼šå¸³å‹™è³‡è¨Š -->
    <section class="card">
      <div class="body">
        <h2 class="h2">å¸³å‹™è³‡è¨Š</h2>
        
        <!-- æ–¹æ¡ˆæ‘˜è¦ -->
        <div class="plan-summary" id="planSummary">
          <div class="plan-name" id="summaryPlanName">Creator Pro é›™å¹´æ–¹æ¡ˆ</div>
          <div class="plan-price" id="summaryPlanPrice">NT$9,900</div>
          <div class="plan-desc" id="summaryPlanDesc">ä¸€æ¬¡è³¼è²·ï¼Œå…©å¹´ä½¿ç”¨</div>
        </div>

        <div class="row">
          <input class="input" placeholder="å§“åï¼ˆæˆ–å…¬å¸æŠ¬é ­ï¼‰" id="name" required />
          <input class="input" placeholder="é›»å­ä¿¡ç®±ï¼ˆæ”¶æ“šèˆ‡é€šçŸ¥ï¼‰" id="email" type="email" required />
          <input class="input" placeholder="æ‰‹æ©Ÿï¼ˆé¸å¡«ï¼‰" id="phone" />
        </div>

        <div class="row" style="margin-top:8px">
          <select class="select" id="invoiceType">
            <option value="personal">ç™¼ç¥¨ï¼šå€‹äºº</option>
            <option value="company">ç™¼ç¥¨ï¼šå…¬å¸ï¼ˆçµ±ç·¨ï¼‰</option>
          </select>
          <input class="input" placeholder="çµ±ä¸€ç·¨è™Ÿï¼ˆé¸æ“‡å…¬å¸æ™‚å¡«å¯«ï¼‰" id="vat" />
        </div>

        <textarea class="textarea" id="note" placeholder="å‚™è¨»ï¼ˆé¸å¡«ï¼‰" style="margin-top:8px"></textarea>

        <div class="hr"></div>

        <div class="h3">ä»˜æ¬¾æ–¹å¼</div>
        <div class="payrow" style="margin-top:8px">
          <a class="paybtn" href="#" onclick="pay('card'); return false;">
            ğŸ’³ ä¿¡ç”¨å¡
            <span style="font-size: 0.85em; color: #64748b; margin-left: 8px;">ï¼ˆæ”¯æ´ LINE Payã€Apple Payã€ATMã€è¶…å•†ç­‰ï¼‰</span>
          </a>
        </div>

        <div class="row" style="margin-top:16px">
          <button class="btn blue" onclick="checkout()" style="width: 100%;">å‰å¾€ä»˜æ¬¾</button>
        </div>
        <div class="small" style="margin-top:10px; text-align: center;">ä»˜æ¬¾å³ä»£è¡¨åŒæ„<a href="#terms" class="link">æœå‹™æ¢æ¬¾èˆ‡é€€è²»æ”¿ç­–</a>ã€‚</div>
      </div>
    </section>

    <!-- å³ï¼šè¨‚å–®æ‘˜è¦ -->
    <section class="card">
      <div class="body">
        <h2 class="h2">è¨‚å–®æ‘˜è¦</h2>
        <div class="sum" aria-live="polite">
          <div class="line"><span id="sumPlan">Creator Pro é›™å¹´æ–¹æ¡ˆ</span><b id="sumPrice">NT$9,900</b></div>
          <div class="line"><span>æ‰‹çºŒè²»</span><b id="fee">NT$0</b></div>
          <div class="line" style="border-top:1px dashed #334155;margin-top:8px;padding-top:8px">
            <span><b>æ‡‰ä»˜é‡‘é¡</b></span><b id="total">NT$9,900</b>
          </div>
        </div>

        <div class="hr"></div>

        <h3 class="h3">æ–¹æ¡ˆå…§å®¹</h3>
        <ul class="list" id="planFeatures">
          <!-- å…§å®¹å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
        </ul>

        <div class="hr"></div>

        <div class="small" style="line-height:1.6;">
          <strong>â€» æ‰€æœ‰æ–¹æ¡ˆçš†ç‚ºä¸€æ¬¡æ€§ä»˜æ¬¾ä¸¦è‡ªå‹•çºŒç´„ï¼Œå¯æ–¼ä¸‹æœŸå‰éš¨æ™‚å–æ¶ˆï¼Œä¸å¦æ”¶çºŒç´„æ‰‹çºŒè²»ã€‚</strong>
        </div>

        <div class="row" style="margin-top:16px">
          <a class="btn ghost" href="subscription.html" style="width: 100%; text-align: center;">â† è¿”å›é¸æ“‡æ–¹æ¡ˆ</a>
        </div>
      </div>
    </section>

  </div>
</main>

<footer class="ft">Â© 2025 ReelMind Â· AI çŸ­å½±éŸ³ï½œAI è…³æœ¬ç”Ÿæˆï½œAI é¡§å•ï½œIP äººè¨­è¦åŠƒ Â· å°ç£</footer>

<script>
  // åƒ¹æ ¼è¨­å®š
  const price = { monthly: 399, yearly: 3990 };
  let currentPlan = 'yearly';
  let testMode = false;  // æ¸¬è©¦æ¨¡å¼æ¨™è¨˜
  let testAmount = null;  // æ¸¬è©¦é‡‘é¡

  function format(n){ return 'NT$' + n.toLocaleString('zh-Hant-TW'); }

  // å¾ URL åƒæ•¸è®€å–æ–¹æ¡ˆ
  function getUrlParam(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
  }

  // åˆå§‹åŒ–ï¼šæ ¹æ“š URL åƒæ•¸è¨­å®šæ–¹æ¡ˆ
  function initPlan() {
    const plan = getUrlParam('plan');
    const amount = getUrlParam('amount');  // æ”¯æ´è‡ªè¨‚é‡‘é¡ï¼ˆç”¨æ–¼æ¸¬è©¦ï¼‰
    
    console.log('ğŸ” initPlan - plan:', plan, 'amount:', amount);
    
    // æª¢æŸ¥æ˜¯å¦ç‚ºæ¸¬è©¦æ¨¡å¼ï¼ˆé€šé amount åƒæ•¸ï¼‰
    if (amount) {
      const amountNum = parseInt(amount);
      console.log('ğŸ” è§£æé‡‘é¡:', amountNum);
      if (amountNum > 0) {
        testMode = true;
        testAmount = amountNum;
        console.log('âœ… æ¸¬è©¦æ¨¡å¼å·²å•Ÿç”¨ï¼Œé‡‘é¡:', testAmount);
      }
    }
    
    if (plan === 'monthly' || plan === 'yearly') {
      currentPlan = plan;
      console.log('âœ… æ–¹æ¡ˆè¨­å®šç‚º:', currentPlan, 'æ¸¬è©¦æ¨¡å¼:', testMode, 'æ¸¬è©¦é‡‘é¡:', testAmount);
      updatePlanDisplay();
    } else {
      // å¦‚æœæ²’æœ‰æ–¹æ¡ˆåƒæ•¸ï¼Œè·³è½‰å›é¸æ“‡é é¢
      window.location.href = 'subscription.html';
    }
  }

  // æ›´æ–°æ–¹æ¡ˆé¡¯ç¤º
  function updatePlanDisplay() {
    const isMonthly = currentPlan === 'monthly';
    
    // è¨ˆç®—å¯¦éš›é‡‘é¡ï¼ˆæ¸¬è©¦æ¨¡å¼ä½¿ç”¨æ¸¬è©¦é‡‘é¡ï¼‰
    const actualAmount = testMode && testAmount ? testAmount : price[currentPlan];
    
    // æ›´æ–°æ–¹æ¡ˆæ‘˜è¦
    let planName, planDesc;
    if (currentPlan === 'yearly') {
      planName = 'Creator Pro å¹´åº¦æ–¹æ¡ˆ';
      planDesc = 'ä¸€æ¬¡ä»˜æ¬¾ï¼Œå…¨å¹´ä½¿ç”¨';
    } else {  // monthly
      planName = 'Script Lite æœˆç§Ÿç‰ˆ';
      planDesc = 'å½ˆæ€§è¨‚é–±ï¼ˆæ¯æœˆæ‰£æ¬¾ï¼‰';
    }
    
    document.getElementById('summaryPlanName').textContent = testMode 
      ? `${planName} (æ¸¬è©¦æ¨¡å¼)` 
      : planName;
    document.getElementById('summaryPlanPrice').textContent = format(actualAmount);
    document.getElementById('summaryPlanDesc').textContent = testMode
      ? `âš ï¸ æ¸¬è©¦æ¨¡å¼ï¼šé‡‘é¡ç‚º NT$${testAmount.toLocaleString('zh-Hant-TW')}`
      : planDesc;

    // æ›´æ–°è¨‚å–®æ‘˜è¦
    const displayPlanName = currentPlan === 'yearly' ? 'Creator Pro å¹´åº¦æ–¹æ¡ˆ' : 'Script Lite æœˆç§Ÿç‰ˆ';
    document.getElementById('sumPlan').textContent = testMode 
      ? `${displayPlanName} (æ¸¬è©¦)` 
      : displayPlanName;
    document.getElementById('sumPrice').textContent = format(actualAmount);
    document.getElementById('total').textContent = format(actualAmount);
    
    // å¦‚æœæ˜¯æ¸¬è©¦æ¨¡å¼ï¼Œé¡¯ç¤ºæ¸¬è©¦æç¤º
    if (testMode) {
      const planSummary = document.getElementById('planSummary');
      if (planSummary && !planSummary.querySelector('.test-badge')) {
        const testBadge = document.createElement('div');
        testBadge.className = 'test-badge';
        testBadge.style.cssText = 'background: #FEF3C7; color: #92400E; padding: 8px 12px; border-radius: 8px; margin-top: 12px; font-size: 12px; font-weight: 600;';
        testBadge.textContent = `âš ï¸ æ¸¬è©¦æ¨¡å¼ï¼šæ­¤ç‚º ${testAmount} å…ƒæ¸¬è©¦ä»˜æ¬¾ï¼Œå°‡ç”¢ç”ŸçœŸå¯¦è¨‚å–®å’Œæˆæ¬Š`;
        planSummary.appendChild(testBadge);
      }
    }

    // å‹•æ…‹æ›´æ–°æ–¹æ¡ˆå…§å®¹åˆ—è¡¨
    const planFeaturesList = document.getElementById('planFeatures');
    if (planFeaturesList) {
      if (currentPlan === 'monthly') {
        // Script Lite æœˆç§Ÿç‰ˆçš„åŠŸèƒ½
        planFeaturesList.innerHTML = `
          <li>AI ä¸€éµç”Ÿæˆï¼šHookã€å£æ’­ã€åˆ†é¡ã€CTA</li>
          <li>å‰µä½œè€…è³‡æ–™åº«ï¼šPDF / CSV ä¸‹è¼‰</li>
          <li>å¯¦æˆ°æŒ‡å—ï¼šè…³æœ¬ç”ŸæˆæŠ€å·§</li>
          <li>å®¢æœæ”¯æ´</li>
        `;
      } else {
        // Creator Pro å¹´åº¦æ–¹æ¡ˆçš„åŠŸèƒ½
        planFeaturesList.innerHTML = `
          <li>åŒ…å«æœˆç§Ÿç‰ˆæ‰€æœ‰åŠŸèƒ½</li>
          <li>IP äººè¨­è¦åŠƒï¼šProfile + 14 å¤©å…§å®¹è¦åŠƒ</li>
          <li>å¤šå¹³å°è…³æœ¬å„ªåŒ–</li>
          <li>é•·æœŸè¨˜æ†¶åº«ä¿å­˜</li>
          <li><strong>å¹´åº¦å°ˆå±¬å„ªæƒ </strong></li>
        `;
      }
    }
  }

  // Toast é€šçŸ¥å‡½æ•¸ï¼ˆå¦‚æœ common.js æœªè¼‰å…¥ï¼Œä½¿ç”¨é™ç´šæ–¹æ¡ˆï¼‰
  function showToast(message, duration = 3000) {
    if (window.ReelMindCommon && window.ReelMindCommon.showToast) {
      window.ReelMindCommon.showToast(message, duration);
      return;
    }
    // é™ç´šæ–¹æ¡ˆï¼šå‰µå»ºç°¡å–®çš„ toast
    let toastEl = document.getElementById('toast');
    if (!toastEl) {
      toastEl = document.createElement('div');
      toastEl.id = 'toast';
      toastEl.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #1f2937;
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 10000;
        display: none;
        opacity: 0;
        transition: opacity 0.3s;
        max-width: 400px;
        word-wrap: break-word;
      `;
      document.body.appendChild(toastEl);
    }
    toastEl.textContent = message;
    toastEl.style.display = 'block';
    toastEl.style.opacity = '1';
    setTimeout(() => {
      toastEl.style.opacity = '0';
      setTimeout(() => {
        toastEl.style.display = 'none';
      }, 300);
    }, duration);
  }

  async function checkout(){
    // ç™»å…¥æª¢æŸ¥
    try {
      var token = localStorage.getItem('ipPlanningToken') || '';
      if (!token) {
        showToast('è«‹å…ˆç™»å…¥å¾Œå†è¨‚é–±', 3000);
        setTimeout(() => {
          try { window.location.href = '/' + '#login'; } catch(_) {}
        }, 1500);
        return;
      }
    } catch(_) {}

    // æ”¶é›†è¨‚å–®è³‡æ–™
    // è¨ˆç®—å¯¦éš›é‡‘é¡ï¼ˆæ¸¬è©¦æ¨¡å¼ä½¿ç”¨æ¸¬è©¦é‡‘é¡ï¼‰
    const actualAmount = testMode && testAmount ? testAmount : price[currentPlan];
    
    const payload = {
      plan: currentPlan,
      amount: actualAmount,  // ä½¿ç”¨å¯¦éš›é‡‘é¡ï¼ˆæ¸¬è©¦æ¨¡å¼æ™‚ç‚ºè‡ªè¨‚é‡‘é¡ï¼‰
      name: document.getElementById('name').value.trim(),
      email: document.getElementById('email').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      invoiceType: document.getElementById('invoiceType').value,
      vat: document.getElementById('vat').value.trim(),
      note: document.getElementById('note').value.trim(),
      frontend_return_url: window.location.origin + '/payment-result.html'
    };
    
    // å‰ç«¯é©—è­‰
    if(!payload.name || !payload.email){
      showToast('è«‹å¡«å¯«å§“åèˆ‡é›»å­ä¿¡ç®±', 3000);
      return;
    }
    
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(payload.email)) {
      showToast('è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­ä¿¡ç®±', 3000);
      return;
    }
    
    if (payload.invoiceType === 'company' && !payload.vat) {
      showToast('é¸æ“‡å…¬å¸ç™¼ç¥¨æ™‚ï¼Œè«‹å¡«å¯«çµ±ä¸€ç·¨è™Ÿ', 3000);
      return;
    }
    
    // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
    const checkoutBtn = document.querySelector('.btn.blue');
    const originalText = checkoutBtn.textContent;
    checkoutBtn.disabled = true;
    checkoutBtn.textContent = 'è™•ç†ä¸­...';
    
    try {
      const response = await fetch('https://api.aijob.com.tw/api/payment/checkout', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      });
      
      if (response.ok) {
        const html = await response.text();
        // æª¢æŸ¥è¿”å›çš„ HTML æ˜¯å¦åŒ…å« ECPay è¡¨å–®
        if (html.includes('ecpayForm') || html.includes('ECPay') || html.includes('payment-stage')) {
          // æ›¿æ›æ•´å€‹é é¢å…§å®¹
          document.body.innerHTML = html;
          // ç¢ºä¿è¡¨å–®æœƒè‡ªå‹•æäº¤
          setTimeout(() => {
            const form = document.getElementById('ecpayForm');
            if (form) {
              console.log('æ‰¾åˆ° ECPay è¡¨å–®ï¼Œæº–å‚™æäº¤...');
              form.submit();
            } else {
              console.error('æ‰¾ä¸åˆ° ECPay è¡¨å–®');
            }
          }, 100);
        } else {
          // å¦‚æœè¿”å›çš„ä¸æ˜¯ ECPay è¡¨å–®ï¼Œå¯èƒ½æ˜¯éŒ¯èª¤è¨Šæ¯
          console.error('å¾Œç«¯è¿”å›çš„å…§å®¹ä¸æ˜¯ ECPay è¡¨å–®:', html.substring(0, 200));
          showToast('ç„¡æ³•è¼‰å…¥ä»˜æ¬¾é é¢ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯ç¹«å®¢æœ', 4000);
          checkoutBtn.disabled = false;
          checkoutBtn.textContent = originalText;
        }
      } else {
        // è™•ç†éŒ¯èª¤å›æ‡‰
        const contentType = response.headers.get('content-type');
        if (contentType && contentType.includes('application/json')) {
          const errorData = await response.json().catch(() => ({ error: 'å»ºç«‹è¨‚å–®å¤±æ•—' }));
          showToast(errorData.error || 'å»ºç«‹è¨‚å–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦', 4000);
        } else {
          const errorText = await response.text().catch(() => 'å»ºç«‹è¨‚å–®å¤±æ•—');
          console.error('å¾Œç«¯éŒ¯èª¤å›æ‡‰:', errorText);
          showToast('å»ºç«‹è¨‚å–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯ç¹«å®¢æœï¼šaiagent168168@gmail.com', 5000);
        }
        checkoutBtn.disabled = false;
        checkoutBtn.textContent = originalText;
      }
    } catch (error) {
      console.error('ä»˜æ¬¾éŒ¯èª¤:', error);
      showToast('ä»˜æ¬¾è™•ç†å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–ç¨å¾Œå†è©¦ã€‚å¦‚æœ‰å•é¡Œè«‹è¯ç¹«å®¢æœï¼šaiagent168168@gmail.com', 5000);
      checkoutBtn.disabled = false;
      checkoutBtn.textContent = originalText;
    }
  }

  function pay(kind){
    checkout();
  }

  // è™•ç†ä»˜æ¬¾çµæœé é¢
  window.addEventListener('DOMContentLoaded', async function() {
    // èª¿è©¦ï¼šæª¢æŸ¥ URL åƒæ•¸
    const urlParams = new URLSearchParams(window.location.search);
    const amount = urlParams.get('amount');
    if (amount) {
      console.log('ğŸ” æª¢æ¸¬åˆ°æ¸¬è©¦æ¨¡å¼ï¼Œé‡‘é¡åƒæ•¸:', amount);
    }
    
    initPlan();
    
    const status = urlParams.get('status');
    const orderId = urlParams.get('order_id');
    const message = urlParams.get('message');
    
    if (status === 'success') {
      showPaymentSuccess(orderId);
    } else if (status === 'pending') {
      await showPaymentPending(orderId);
    } else if (status === 'failed' || status === 'error') {
      showPaymentError(message || 'ä»˜æ¬¾å¤±æ•—');
    }
  });
  
  async function showPaymentPending(orderId) {
    if (!orderId) {
      showPaymentError('è¨‚å–®ç·¨è™Ÿä¸å­˜åœ¨');
      return;
    }
    
    try {
      const token = localStorage.getItem('ipPlanningToken') || '';
      const response = await fetch(`https://api.aijob.com.tw/api/user/orders`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      
      if (response.ok) {
        const data = await response.json();
        const order = data.orders?.find(o => o.order_id === orderId);
        
        if (order) {
          const paymentMethod = order.payment_method || '';
          const paymentCode = order.payment_code || '';
          const bankCode = order.bank_code || '';
          const expireDate = order.expire_date || '';
          
          const mainContent = document.querySelector('.safe.grid');
          if (mainContent) {
            mainContent.style.display = 'none';
          }
          
          let paymentInfoHTML = '';
          if (paymentMethod === 'ATM') {
            paymentInfoHTML = `
              <div style="background: #f8f9fa; padding: 24px; border-radius: 8px; margin: 24px 0;">
                <h3 class="h3" style="margin-bottom: 16px;">ATM è½‰å¸³è³‡è¨Š</h3>
                ${bankCode ? `<p class="sub" style="margin-bottom: 8px;"><strong>éŠ€è¡Œä»£ç¢¼ï¼š</strong>${bankCode}</p>` : ''}
                ${paymentCode ? `<p class="sub" style="margin-bottom: 8px;"><strong>è™›æ“¬å¸³è™Ÿï¼š</strong><code style="background: white; padding: 4px 8px; border-radius: 4px; font-size: 1.1em;">${paymentCode}</code></p>` : ''}
                ${expireDate ? `<p class="small" style="color: var(--red); margin-top: 16px;">âš ï¸ è«‹æ–¼ ${expireDate} å‰å®Œæˆè½‰å¸³</p>` : ''}
              </div>
            `;
          } else if (paymentMethod === 'CVS' || paymentMethod === 'BARCODE') {
            paymentInfoHTML = `
              <div style="background: #f8f9fa; padding: 24px; border-radius: 8px; margin: 24px 0;">
                <h3 class="h3" style="margin-bottom: 16px;">è¶…å•†ä»£ç¢¼</h3>
                ${paymentCode ? `<p class="sub" style="margin-bottom: 8px;"><strong>ä»˜æ¬¾ä»£ç¢¼ï¼š</strong><code style="background: white; padding: 4px 8px; border-radius: 4px; font-size: 1.1em;">${paymentCode}</code></p>` : ''}
                ${expireDate ? `<p class="small" style="color: var(--red); margin-top: 16px;">âš ï¸ è«‹æ–¼ ${expireDate} å‰è‡³è¶…å•†å®Œæˆä»˜æ¬¾</p>` : ''}
                <p class="small" style="margin-top: 16px;">è«‹è‡³ 7-11ã€å…¨å®¶ã€èŠçˆ¾å¯Œã€OK è¶…å•†ç­‰é–€å¸‚ï¼Œä½¿ç”¨å¤šåª’é«”æ©Ÿå°è¼¸å…¥ä»£ç¢¼å®Œæˆä»˜æ¬¾</p>
              </div>
            `;
          }
          
          const pendingHTML = `
            <div class="safe" style="margin-top: 40px;">
              <section class="card">
                <div class="body" style="text-align: center; padding: 40px 20px;">
                  <div style="font-size: 64px; margin-bottom: 20px;">â³</div>
                  <h2 class="h2" style="color: var(--warn); margin-bottom: 12px;">å–è™ŸæˆåŠŸï¼Œå¾…ä»˜æ¬¾</h2>
                  <p class="sub" style="margin-bottom: 24px;">è«‹ä¾ç…§ä¸‹æ–¹è³‡è¨Šå®Œæˆä»˜æ¬¾ï¼Œä»˜æ¬¾å®Œæˆå¾Œç³»çµ±å°‡è‡ªå‹•é–‹é€šæ‚¨çš„å¸³è™Ÿ</p>
                  ${orderId ? `<p class="small" style="margin-bottom: 24px;">è¨‚å–®ç·¨è™Ÿï¼š${orderId}</p>` : ''}
                  ${paymentInfoHTML}
                  <div class="row" style="justify-content: center; gap: 12px; margin-top: 24px;">
                    <button class="btn blue" onclick="window.location.href='/'">è¿”å›é¦–é </button>
                    <button class="btn ghost" onclick="checkOrderStatus('${orderId}')">æª¢æŸ¥ä»˜æ¬¾ç‹€æ…‹</button>
                  </div>
                </div>
              </section>
            </div>
          `;
          
          const container = document.querySelector('.wrap');
          if (container) {
            container.insertAdjacentHTML('beforeend', pendingHTML);
          }
        } else {
          showPaymentError('æ‰¾ä¸åˆ°è¨‚å–®è³‡è¨Š');
        }
      } else {
        showPaymentError('ç„¡æ³•æŸ¥è©¢è¨‚å–®è³‡è¨Š');
      }
    } catch (error) {
      console.error('æŸ¥è©¢è¨‚å–®å¤±æ•—:', error);
      showPaymentError('æŸ¥è©¢è¨‚å–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
    }
  }
  
  async function checkOrderStatus(orderId) {
    try {
      const token = localStorage.getItem('ipPlanningToken') || '';
      const response = await fetch(`https://api.aijob.com.tw/api/user/orders`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      
      if (response.ok) {
        const data = await response.json();
        const order = data.orders?.find(o => o.order_id === orderId);
        
        if (order) {
          if (order.payment_status === 'paid') {
            alert('ä»˜æ¬¾æˆåŠŸï¼æ‚¨çš„å¸³è™Ÿå·²é–‹é€š');
            window.location.href = '/';
          } else {
            alert('å°šæœªå®Œæˆä»˜æ¬¾ï¼Œè«‹å®Œæˆä»˜æ¬¾å¾Œå†è©¦');
          }
        } else {
          alert('æ‰¾ä¸åˆ°è¨‚å–®è³‡è¨Š');
        }
      } else {
        alert('ç„¡æ³•æŸ¥è©¢è¨‚å–®ç‹€æ…‹');
      }
    } catch (error) {
      console.error('æª¢æŸ¥è¨‚å–®ç‹€æ…‹å¤±æ•—:', error);
      alert('æª¢æŸ¥è¨‚å–®ç‹€æ…‹å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
    }
  }
  
  function showPaymentSuccess(orderId) {
    const mainContent = document.querySelector('.safe.grid');
    if (mainContent) {
      mainContent.style.display = 'none';
    }
    
    const successHTML = `
      <div class="safe" style="margin-top: 40px;">
        <section class="card">
          <div class="body" style="text-align: center; padding: 40px 20px;">
            <div style="font-size: 64px; margin-bottom: 20px;">âœ…</div>
            <h2 class="h2" style="color: var(--ok); margin-bottom: 12px;">ä»˜æ¬¾æˆåŠŸï¼</h2>
            <p class="sub" style="margin-bottom: 24px;">æ„Ÿè¬æ‚¨çš„è¨‚é–±ï¼Œæ‚¨çš„å¸³è™Ÿå·²é–‹é€šä½¿ç”¨æ¬Šé™</p>
            ${orderId ? `<p class="small" style="margin-bottom: 24px;">è¨‚å–®ç·¨è™Ÿï¼š${orderId}</p>` : ''}
            <div class="row" style="justify-content: center; gap: 12px;">
              <button class="btn blue" onclick="window.location.href='/'">é–‹å§‹ä½¿ç”¨</button>
              <button class="btn ghost" onclick="window.location.href='subscription.html'">æŸ¥çœ‹è¨‚å–®</button>
            </div>
          </div>
        </section>
      </div>
    `;
    
    const container = document.querySelector('.wrap');
    if (container) {
      container.insertAdjacentHTML('beforeend', successHTML);
    }
  }
  
  function showPaymentError(message) {
    const mainContent = document.querySelector('.safe.grid');
    if (mainContent) {
      mainContent.style.display = 'none';
    }
    
    const errorHTML = `
      <div class="safe" style="margin-top: 40px;">
        <section class="card">
          <div class="body" style="text-align: center; padding: 40px 20px;">
            <div style="font-size: 64px; margin-bottom: 20px;">âŒ</div>
            <h2 class="h2" style="color: var(--red); margin-bottom: 12px;">ä»˜æ¬¾å¤±æ•—</h2>
            <p class="sub" style="margin-bottom: 24px;">${message}</p>
            <div class="row" style="justify-content: center; gap: 12px;">
              <button class="btn blue" onclick="window.location.href='checkout.html?plan=' + '${currentPlan}'">é‡æ–°ä»˜æ¬¾</button>
              <button class="btn ghost" onclick="window.location.href='subscription.html'">è¿”å›é¸æ“‡æ–¹æ¡ˆ</button>
            </div>
          </div>
        </section>
      </div>
    `;
    
    const container = document.querySelector('.wrap');
    if (container) {
      container.insertAdjacentHTML('beforeend', errorHTML);
    }
  }
</script>

<!-- è¼‰å…¥ API å’Œèªè­‰æ¨¡çµ„ï¼ˆè‡ªå‹•è™•ç† CSRF Tokenï¼‰ -->
<script>
  window.APP_CONFIG = {
    API_BASE: 'https://api.aijob.com.tw'
  };
</script>
<script src="assets/js/auth.js?v=20251120"></script>
<script src="assets/js/api.js?v=20251120"></script>

</body>
</html>

