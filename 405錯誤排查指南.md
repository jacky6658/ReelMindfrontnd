# 405 éŒ¯èª¤æ’æŸ¥æŒ‡å—

> è§£æ±º `payment-result.html` å‡ºç¾ 405 Not Allowed éŒ¯èª¤

## ğŸ” å•é¡Œæè¿°

**ç—‡ç‹€ï¼š**
- å¾Œç«¯æ—¥èªŒé¡¯ç¤ºä»˜æ¬¾æˆåŠŸï¼š`[ECPay RETURN-URL]è¨‚å–®å·²æ›´æ–°ç‚ºå·²ä»˜æ¬¾,ä¸¦å»ºç«‹æˆæ¬Šè¨˜éŒ„`
- å‰ç«¯è¨ªå• `payment-result.html` æ™‚å‡ºç¾ **405 Not Allowed** éŒ¯èª¤
- åŒæ™‚å¯èƒ½å‡ºç¾ `favicon.ico` çš„ 404 éŒ¯èª¤

## âœ… å·²å®Œæˆçš„ä¿®å¾©

### 1. æ›´æ–° Nginx é…ç½®

å·²æ›´æ–° `nginx.conf`ï¼Œç¢ºä¿ï¼š
- âœ… `payment-result.html` æœ‰å°ˆé–€çš„ location é…ç½®ï¼ˆæœ€é«˜å„ªå…ˆç´šï¼‰
- âœ… æ‰€æœ‰ HTML æ–‡ä»¶éƒ½æœ‰æ˜ç¢ºçš„ Content-Type è¨­å®š
- âœ… favicon.ico æœ‰å°ˆé–€è™•ç†ï¼ˆé¿å… 404 éŒ¯èª¤ï¼‰

### 2. é…ç½®å…§å®¹

```nginx
# ç‰¹åˆ¥è™•ç† payment-result.htmlï¼ˆæœ€é«˜å„ªå…ˆç´šï¼‰
location = /payment-result.html {
    add_header Content-Type "text/html; charset=utf-8";
    add_header X-Content-Type-Options "nosniff";
    try_files $uri =404;
}

# è™•ç† faviconï¼ˆé¿å… 404 éŒ¯èª¤ï¼‰
location = /favicon.ico {
    log_not_found off;
    access_log off;
    try_files $uri =204;
}
```

## ğŸš€ è§£æ±ºæ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šé‡æ–°éƒ¨ç½²å‰ç«¯æœå‹™

1. æäº¤æ›´æ–°çš„ `nginx.conf` å’Œ `Dockerfile` åˆ° GitHub
2. åœ¨ Zeabur å¾Œå°è§¸ç™¼é‡æ–°éƒ¨ç½²
3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸ 2-5 åˆ†é˜ï¼‰

### æ­¥é©Ÿ 2ï¼šé©—è­‰é…ç½®å·²ç”Ÿæ•ˆ

```bash
# æª¢æŸ¥ payment-result.html æ˜¯å¦å¯ä»¥è¨ªå•
curl -I https://reelmind.aijob.com.tw/payment-result.html

# é æœŸéŸ¿æ‡‰ï¼š
# HTTP/1.1 200 OK
# Content-Type: text/html; charset=utf-8
```

### æ­¥é©Ÿ 3ï¼šæ¸¬è©¦ä»˜æ¬¾æµç¨‹

1. ç™¼èµ·æ¸¬è©¦ä»˜æ¬¾ï¼ˆ1 å…ƒæˆ– 10 å…ƒï¼‰
2. å®Œæˆä»˜æ¬¾å¾Œï¼Œæª¢æŸ¥æ˜¯å¦æ­£å¸¸è·³è½‰åˆ° `payment-result.html`
3. ç¢ºèªé é¢å¯ä»¥æ­£å¸¸é¡¯ç¤ºä»˜æ¬¾çµæœ

## ğŸ”§ å¦‚æœå•é¡Œä»ç„¶å­˜åœ¨

### æª¢æŸ¥ 1ï¼šZeabur é…ç½®

å¦‚æœé‡æ–°éƒ¨ç½²å¾Œä»æœ‰å•é¡Œï¼Œå¯èƒ½æ˜¯ Zeabur çš„åå‘ä»£ç†é…ç½®ï¼š

1. ç™»å…¥ Zeabur å¾Œå°
2. æª¢æŸ¥å‰ç«¯æœå‹™çš„ **è·¯ç”±é…ç½®**ï¼ˆRoutesï¼‰
3. ç¢ºèªæ²’æœ‰ç‰¹æ®Šçš„è·¯ç”±è¦å‰‡æ””æˆª `/payment-result.html`

### æª¢æŸ¥ 2ï¼šç€è¦½å™¨å¿«å–

æ¸…é™¤ç€è¦½å™¨å¿«å–å¾Œé‡è©¦ï¼š
- Chrome: `Ctrl+Shift+Delete` (Windows) æˆ– `Cmd+Shift+Delete` (Mac)
- é¸æ“‡ã€Œå¿«å–çš„åœ–ç‰‡å’Œæª”æ¡ˆã€
- é‡æ–°è¼‰å…¥é é¢

### æª¢æŸ¥ 3ï¼šç›´æ¥è¨ªå•æ¸¬è©¦

åœ¨ç€è¦½å™¨ç›´æ¥è¨ªå•ï¼š
```
https://reelmind.aijob.com.tw/payment-result.html?status=success&order_id=TEST123
```

å¦‚æœç›´æ¥è¨ªå•å¯ä»¥æ­£å¸¸é¡¯ç¤ºï¼Œå•é¡Œå¯èƒ½åœ¨æ–¼ï¼š
- ç¶ ç•Œè¿”å› URL çš„æ ¼å¼
- æŸäº›åƒæ•¸å°è‡´è·¯ç”±å•é¡Œ

### æª¢æŸ¥ 4ï¼šå¾Œç«¯æ—¥èªŒ

æŸ¥çœ‹å¾Œç«¯æ—¥èªŒï¼Œç¢ºèªï¼š
- âœ… Webhook å·²æˆåŠŸè™•ç†
- âœ… è¨‚å–®ç‹€æ…‹å·²æ›´æ–°ç‚º `paid`
- âœ… æˆæ¬Šè¨˜éŒ„å·²å»ºç«‹

å³ä½¿å‰ç«¯å‡ºç¾ 405 éŒ¯èª¤ï¼Œ**å¾Œç«¯è™•ç†æ‡‰è©²å·²ç¶“å®Œæˆ**ï¼Œæˆæ¬Šæ‡‰è©²å·²ç¶“ç”Ÿæ•ˆã€‚

## ğŸ“Š é©—è­‰æˆæ¬Šæ˜¯å¦æˆåŠŸ

å³ä½¿å‰ç«¯å‡ºç¾ 405 éŒ¯èª¤ï¼Œå¦‚æœå¾Œç«¯æ—¥èªŒé¡¯ç¤ºæˆåŠŸï¼Œæˆæ¬Šæ‡‰è©²å·²ç¶“å»ºç«‹ã€‚å¯ä»¥é€šéä»¥ä¸‹æ–¹å¼é©—è­‰ï¼š

### æ–¹æ³• 1ï¼šAPI æŸ¥è©¢

```bash
# åœ¨ç€è¦½å™¨ Console åŸ·è¡Œ
const token = localStorage.getItem('ipPlanningToken');
const response = await fetch('https://aivideobackend.zeabur.app/api/user/subscription', {
  headers: { 'Authorization': `Bearer ${token}` }
});
const data = await response.json();
console.log('è¨‚é–±ç‹€æ…‹:', data);
```

### æ–¹æ³• 2ï¼šè³‡æ–™åº«æŸ¥è©¢

```sql
-- æŸ¥è©¢è¨‚å–®ç‹€æ…‹
SELECT order_id, payment_status, paid_at
FROM orders
WHERE order_id = 'YOUR_ORDER_ID';

-- æŸ¥è©¢æˆæ¬Šè¨˜éŒ„
SELECT user_id, tier, status, expires_at
FROM licenses
WHERE user_id = 'YOUR_USER_ID'
ORDER BY created_at DESC
LIMIT 1;
```

## ğŸ’¡ è‡¨æ™‚è§£æ±ºæ–¹æ¡ˆ

å¦‚æœé‡æ–°éƒ¨ç½²å¾Œä»æœ‰å•é¡Œï¼Œå¯ä»¥ï¼š

1. **æ‰‹å‹•è¨ªå•çµæœé é¢**ï¼š
   - å¾å¾Œç«¯æ—¥èªŒç²å–è¨‚å–® ID
   - æ‰‹å‹•è¨ªå•ï¼š`https://reelmind.aijob.com.tw/payment-result.html?order_id=YOUR_ORDER_ID&status=success`

2. **ä½¿ç”¨ API é©—è­‰æˆæ¬Š**ï¼š
   - å³ä½¿å‰ç«¯ç„¡æ³•é¡¯ç¤ºï¼Œæˆæ¬Šæ‡‰è©²å·²ç¶“å»ºç«‹
   - ä½¿ç”¨ API æŸ¥è©¢ç¢ºèªæˆæ¬Šç‹€æ…‹

## ğŸ”— ç›¸é—œæ–‡ä»¶

- [ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦æµç¨‹.md](../ReelMindbackend-main/ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦æµç¨‹.md)
- [ç¶ ç•Œç”Ÿç”¢ç’°å¢ƒ1å…ƒæ¸¬è©¦æŒ‡å—.md](../ReelMindbackend-main/ç¶ ç•Œç”Ÿç”¢ç’°å¢ƒ1å…ƒæ¸¬è©¦æŒ‡å—.md)

---

**é‡è¦æé†’ï¼š** å³ä½¿å‰ç«¯å‡ºç¾ 405 éŒ¯èª¤ï¼Œå¦‚æœå¾Œç«¯æ—¥èªŒé¡¯ç¤ºä»˜æ¬¾æˆåŠŸï¼Œæˆæ¬Šæ‡‰è©²å·²ç¶“å»ºç«‹ã€‚è«‹å…ˆé©—è­‰æˆæ¬Šç‹€æ…‹ï¼Œå†è™•ç†å‰ç«¯é¡¯ç¤ºå•é¡Œã€‚

